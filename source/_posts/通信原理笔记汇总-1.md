---
title: '通信原理笔记汇总'
date: 2020-06-23 17:02:00
comments: true
categories: [电子信息]
tags: [通信原理]
keywords: 笔记
mathjax: true
---


本文是某三本大学2020《通信原理》课程的知识点汇总。

<!-- more -->
 

# 第三章 模拟线性调制

## 3.1 双边带调幅

### 1. 常规双边带调幅（AM）

1. 时域表达式

   $$S_{\mathrm{AM} }(t)=\left[A_{0}+f(t)\right] \cos \left(\omega_{C} t+\theta_{C}\right)$$

   其中，$A_0$为外加的直流分量，$f(t)$为调制信号，通常认为**平均值为0**，即**没有直流分量**。

1. AM信号的带宽：$B = 2\omega_H$，其中$\omega_H$是调制信号（基带信号）$f(t)$的角频率。

1. AM的频谱

   图中的字母表示有点不一样，$M(\omega)$是调制信号的傅里叶变换，即$F(\omega)$。

   <img src="https://vicumi-1300325441.cos.ap-beijing.myqcloud.com/通信原理/[通信原理][3.1]AM频谱.png" alt="image-20200526164612718" style="zoom: 80%;" />

1. AM的调制与解调

   1. 包络检波

      要求：$A_0 + f(t) \geq 0$

   1. 相干解调

      将接收信号乘以一个同频载波，接着用低通滤波器恢复出原始的调制信号。

1. AM特点

   1. 波形：完全反映调制信号的变化规律

   1. 频谱：由载频分量、上边带、下边带组成，其中下边带是上边带的镜像。

   1. 带宽：是基带信号带宽的2倍，公式见上面。

   1. **功率**分配：载波功率$S_C$+边带功率$S_f$，只有边带功率和调制信号有关，载波分量不携带信息。

      其中$S_{C}=\frac{A_{0}^{2} }{2}$，$S_{f}=\frac{\overline{f^{2}(t)} }{2}$

   1. 调制效率：$$\eta_{\mathrm{AM} }=S_{f} / S_{\mathrm{AM} }=\overline{f^{2}(t)} /\left[A_{0}^{2}+\overline{f^{2}(t)}\right]$$

      当调制信号为单频余弦信号时，$\overline{f^{2}(t)}=\frac{A_{m}^{2} }{2}$，此时

      $$\eta_{\mathrm{AM} } = \frac{S_f}{S_C+S_f} = \frac{\frac{A_m^2}{4} }{\frac{A_0^2}{2}+\frac{A_m^2}{4} } = \frac{A_{m}^{2} }{2 A_{0}^{2}+A_{m}^{2} }=\frac{\beta_{\text {AM } }^{2} }{2+\beta_{\text {AM } }^{2} }$$

      其中$\beta_{\mathrm{AM} }=\frac{A_{\mathrm{m} }}{A_{0} } \leq 1$，为调幅指数。在刚发生过调制的情况下，$\beta_{\mathrm{AM} }=1$，这时的调制效率达到**最大值**，$\mathrm{max}(\eta_{\mathrm{AM} })=\frac{1}{3}$。


### 2. 抑制载波双边带调幅（DSB-SC，简写DSB）

如前所述，在常规双边带调幅中载波功率是无用的，因为载波不携带任何信息，信息完全由边带传送。如果要将载波抑制，只需**不附加直流分量**$A_0$即可得到抑制载波的双边带调幅。

1. 时域表达式：$S_{\mathrm{DSB} }(t)=f(t) \cos \omega_{C} t$

1. DSB的频谱

   $$S_{\mathrm{DSB} }(\omega)=\frac{1}{2} F\left(\omega-\omega_{C}\right)+\frac{1}{2} F\left(\omega+\omega_{C}\right)$$

   图中可以看出，DSB的**带宽**依然是**调制信号的2倍**，$B_{\rm DSB} = 2\omega_H$。

   <img src="https://vicumi-1300325441.cos.ap-beijing.myqcloud.com/通信原理/[通信原理][3.1]DSB频谱.png" alt="image-20200526185550526" style="zoom:50%;" />

1. DSB调制效率：由于载波功率为0，因此$\eta_{\rm DSB} = 1$。

1. DSB解调

   1. **不能直接使用包络检波**（从DSB的时域波形可以明显看出）
   1. **相干解调**方式和AM一样

### 3. AM和DSB的调制与解调总结

1. 调制

   1. 原理：常规双边带调幅（AM）则是调制信号叠加直流分量后与载波相乘，而抑制载波双边带调幅（DSB）的调制过程实际上就是调制信号与载波的相乘运算。

   1. 要求：**<u>载频$f_C$必须大于调制信号最高频率的两倍</u>**。

   1. 调制模型

      ![image-20200526190833883](https://vicumi-1300325441.cos.ap-beijing.myqcloud.com/通信原理/[通信原理][3.1]AM与DSB调制方框图.png)

1. 解调

   1. 包络检波（非相干解调）：只有**AM可以**使用，DSB不能。

   1. 相干解调：将已调信号乘上一个同频同相的载波，再通过低通滤波器恢复信号

 

## 3.2 单边带调制（SSB）

### 1. SSB的表达式

1. 频域表达式

   $$\mathcal{S}_{\mathrm{SSB} }(\omega)=S_{\mathrm{DSB} }(\omega) \cdot H_{\mathrm{SSB} }(\omega)$$

   其中$H_{\mathrm{SSB} }(\omega)$为单边带滤波器的传递函数，由此导出了下文产生SSB信号的第一种方法——**滤波法**。

   1. 上边带USB：保留上边带（外侧边带）
   1. 下边带LSB：保留下边带（内侧边带）

1. 时域表达式

   对于一般信号而言，需要使用[希尔伯特变换](https://zh.wikipedia.org/wiki/希爾伯特轉換)，对调制信号$f(t)$变换得$\hat{f}(t)$。对于单频余弦信号，则只需要移相$-90^{\circ}$即可得到希尔伯特变换。由此引出了下文得第二种产生SSB信号得方法——**相移法**。

   1. 上边带USB

      $$S_{\rm USB}(t)=\frac{1}{2} f(t) \cos \omega_{C} t-\frac{1}{2} \hat{f}(t) \sin \omega_{C} t $$

   1. 下边带LSB

      $$S_{\mathrm{LSB} }(t)=\frac{1}{2} f(t) \cos \omega_C t+\frac{1}{2} \hat{f}(t) \sin \omega_C t$$

### 2. SSB的产生方式（调制）

1. 滤波法：在DSB的基础上滤波，原理已在上文给出。

   $$H_{\mathrm{USB} }(\omega)=\left\{\begin{array}{ll} 1, & |\omega|>\omega_{C} \\ 0, & |\omega| \leqslant \omega_{C} \end{array}\right.$$

   $$H_{\mathrm{LSB} }(\omega)=\left\{\begin{array}{ll} 1, & |\omega|<\omega_{C} \\ 0, & |\omega| \geqslant \omega_{C} \end{array}\right.$$

1. 相移法

   说明：两路相乘结果相减时得到上边带信号，相加时则得下边带信号。

   <img src="https://vicumi-1300325441.cos.ap-beijing.myqcloud.com/通信原理/[通信原理][3.2]单边带信号的相移法生成.png" alt="image-20200526202814710" style="zoom:80%;" />

### 3. SSB的解调

1. 相干解调：<u>和AM相同</u>
1. 非相干解调：插入强载波+包络检波

### 4. SSB的缺点

对边带滤波器的要求极高（过渡带无限陡），实际制造这样的滤波器非常困难（不可能实现）。解决措施是对一个边带进行逐渐截止——残留边带调制（VSB）。

 

## 3.3 残留边带调制（VSB）

### 特点

1. 介于DSB和SSB之间。与SSB相比，频带稍微增宽了一些。

1. 传送一个边带，还保留是个边带的一部分（对其进行逐渐截止）。

1. VSB的调制与解调

   1. 调制：原理上可以使用相移法，凡是实际使用时都采用<u>滤波法</u>。

      为了使相干解调时无失真地得到解调信号，VSB的滤波器在载频（$\pm\omega_C$）附近必须具有**<font color=red><u>互补对称特性</u></font>**。

   1. 解调：同样不能使用包络检波，必须使用**相干解调**。

 

## 3.4 线性调制的一般模型

### 1. 线性调制信号产生的一般模型

1. 频域表达式

   $$S(\omega)=\frac{1}{2} H(\omega)\left[F\left(\omega-\omega_{C}\right)+F\left(\omega+\omega_{C}\right)\right]$$

1. 时域表达式

   $$S(t)=S_{I}(t) \cos \omega_{C} t+S_{Q}(t) \sin \omega_{C} t$$

   其中，$S_{I}(t)$和$S_Q (t)$分别称为同相分量幅度和正交分量幅度。

### 2. 相干解调的一般模型

1. 相干解调的概念：利用已调信号的<u>相位变化</u>来恢复调制信号$\Rightarrow$将已调信号与本地载波相乘。

1. 相干解调适用于所有线性调制（AM、DSB、SSB、VSB）

1. 模型方框图

   <img src="https://vicumi-1300325441.cos.ap-beijing.myqcloud.com/通信原理/[通信原理][3.4]线性调制相干解调的一般模型.png" alt="image-20200526211103457" style="zoom: 67%;" />

### 3. 插入载波包络检波

1. 非相干解调的概念：从已调信号的<u>幅度变化</u>中提取调制信号。
1. 插入（很强的）载波再进行包络检波的方法适用于DSB、SSB和VSB。
1. 直接包络检波适用于AM。

### 4. 正交载波复用

已调信号包含两路**载波相互正交**的的信号：

$$S(t) =A_{c} f_{1}(t) \cos \left(2 \pi f_{c} t\right) +A_{c} f_{2}(t) \sin \left(2 \pi f_{c} t\right) $$

接收端能够分离出$f_1 (t)$和$f_2 (t)$。所以，可以在<u>相同的带宽</u>下，利用正交载波，传输两路信号。

 

## 3.5 线性调制系统的抗噪声性能

### 1. 线性调制相干解调的抗噪声性能

1. 噪声对通信系统的影响是在**接收端**引入的

1. 明确各种参量的数学关系（字母以教材为准）

   1. 带宽

      设$W$为调制信号的带宽，$B$为已调信号的频带宽度（带通滤波器的带宽）。

      1. 单边：$B_{\rm SSB} = W$
      1. 双边：$B_{\rm DSB} = 2W$

   1. 功率谱密度

      1. 单边：$n_0$
      1. 双边：$\frac{n_0}{2}$

   1. 解调器噪声输入功率：$N_{i} = n_{0}B$

   1. 中心频率

      1. AM和DSB：$\omega_0 = \omega_C$，$f_0 = f_C$
      1. SSB：$\frac{1}{2 \pi}\left|\omega_{0}-\omega_{C}\right|=\frac{W}{2}$

   1. 解调信噪比增益——衡量解调器的好坏

      $$G=\frac{S_{0} / N_{0} }{S_{i} / N_{i} }$$

   1. 分析思路

      一般而言，输入的信噪比${\rm SNR}_i$比较好算：计算调制信号的功率（$S_i$）和输入噪声的功率（$N_i$），即可得到${\rm SNR}_i$，再通过不同系统的信噪比增益（在后文会有结论）计算出输出信噪比${\rm SNR}_o$。如果还有多余的条件，根据题目要求进行计算。

1. DSB的相干解调

   1. 输入信噪比

      由于

      $$S_i = \frac{1}{2} \overline{f^2 (t)}, \quad N_i = n_{0} B_{\rm DSB} = 2n_{0}W$$

      则有

      $${\rm SNR}_i = \frac{1}{4} \frac{\overline{f^2 (t)} }{n_{0}W}$$

   1. 输出信噪比

      由于

      $$S_o = \overline{[\frac{1}{2}S_{I}(t)]^2}=\frac{1}{4} \overline{f^2 (t)}, \quad N_o = \overline{[\frac{1}{2}n_{I}(t)]^2}=\frac{1}{4}n_{0}B_{\rm DSB} = \frac{1}{2}n_{o}W$$

      则有

      $${\rm SNR}_o = \frac{1}{2} \frac{\overline{f^2 (t)} }{n_{0}W}$$

   1. **<u>信噪比增益</u>**

      $$G = \frac{ {\rm SNR}_o}{ {\rm SNR}_i} = 2$$

1. AM的相干解调

   输入信号功率中多出了一个载波功率$A^2 / 2$（不算作噪声功率），因此有

   $${\rm SNR}_i = \frac{1}{4} \frac{\overline{f^2 (t)}+A^2}{n_{0}W}$$

   输入噪声功率相同与DSB，因此**<u>信噪比增益</u>**为

   $$G = 2 \cdot \frac{\overline{f^2 (t)} }{A^2 + \overline{f^2 (t)} } < 2$$

   即多了一个分式因子。

1. SSB的相干解调

   1. 输入信噪比

      输入信号的功率与DSB相比，只有一个边带

      $$S_i = \frac{1}{4} \overline{f^2 (t)}$$

      <u>输入噪声功率</u>为

      $$N_i = n_0 B_{\rm SSB} = n_0 W$$

      因此

      $${\rm SNR}_i = \frac{1}{4} \frac{\overline{f^2 (t)} }{n_{0}W}$$

   1. 输出信噪比

      SSB解调输出的信号为$\frac{1}{4}f(t)$。原因：根据公式，SSB调制的时候幅度变为调制信号的一半（$S_I (t) = \frac{1}{2}f(t)$），解调的时候输出信号幅度变为解调输入信号的一半，因此最后是变为四分之一原信号的幅度。因此，有

      $$S_o = \overline{[\frac{1}{2}S_{I}(t)]^2}=\frac{1}{16} \overline{f^2 (t)}, \quad N_o = \overline{[\frac{1}{2}n_{I}(t)]^2}=\frac{1}{4}n_{0}B_{\rm SSB} = \frac{1}{4}n_{o}W$$

      则

      $${\rm SNR}_o = \frac{1}{4} \frac{\overline{f^2 (t)} }{n_{0}W}$$

   1. **<u>信噪比增益</u>**

      $$G = \frac{ {\rm SNR}_o}{ {\rm SNR}_i} = 1$$

1. 几种类型的线性调制系统的抗噪声性能的对比

   注意：表中的频带带宽$B$应该是文中的$W$。

   <img src="https://vicumi-1300325441.cos.ap-beijing.myqcloud.com/通信原理/[通信原理][3.5]抗噪声性能的对比.png" style="zoom:67%;" />

1. 线性调制系统相干解调性能的分析和比较

   1. 有效性与可靠性

      **<font color=red><u>对于模拟信号而言，可靠性看解调信噪比，有效性看频带利用率。</u></font>**

   1. 可靠性分析（抗噪声性能）

      1. 结论：SSB = DSB > AM，VSB的性能可能与SSB相当。

      1. 原理和注意事项

         需要注意的是SSB和DSB的比较。虽然经过上文的计算推导得到信噪比增益是$G_{\rm SSB}=1 < G_{\rm DSB}=2$，但是可以发现这个计算过程中DSB的输入信号的功率是SSB输入信号功率的2倍（因为DSB占了2倍的频带），导致DSB的输出信噪比也是SSB的2倍。**<font color=red>若要比较两者的抗噪声性能，必须在相同输入信号功率$S_i$、相同输入噪声功率密度$n_0$、相同的调制信号带宽$W$的情况下，比较输出的信噪比。</font>**所以，实际上SSB和DSB的抗噪声性能**相同**。

   1. 有效性比较：SSB > VSB > DSB = AM

### 2. 常规调幅（AM）包络检波的抗噪声性能

1. 大信噪比的情况——输入信号幅度远大于噪声幅度，${\rm SNR}_i \gg 1$

   此时包络检波的可靠性和AM相干解调时相同，即$G_{\rm AM} = 2 \cdot \frac{\overline{f^2 (t)} }{A^2 + \overline{f^2 (t)} }$

1. 小信噪比的情况——噪声幅度远大于输入信号幅度，${\rm SNR}_i \ll 1$

   1. 此时将出现**门限效应**
   1. 门限效应：当包络检波器的输入信噪比下降到一个特定的阈值之后，调制信号无法与噪声分开，且有用的信号“淹没”在噪声之中。此时的输出信噪比不是按比例随着输入信噪比下降，而是<u>急剧恶化</u>，这种现象被称为门限效应。这个阈值被称为门限值。
   1. **<u>相干解调不存在门限效应，门限效应一定会且仅会发生在非相干解调接收机中</u>**。

 

 

# 第四章 模拟角调制

## 4.1 角调制的基本概念

1. 载波信号的时域表示

   $$C(t)=A \cos \left(\omega_{C} t+\phi\right)$$

   其中幅度$A$、角频率$\omega_C$和相位$\phi$这三个参数都可以用来携带信息而构成已调制信号。幅度调制已经在模拟线性调制中学习过。

   需要注意的是，线性调制是幅度调制，非线性调制包括频率调制和相位调制。

1. 相位调制

   1. 特点：幅度和频率保持不变，而**瞬时相位是调制信号的线性函数**。

   1. 瞬时相位：$\phi(t)=K_{\mathrm{PM} } f(t)+\phi_{0}$

      式中的$K_{\rm PM}$称为<u>相移常数</u>，是取决于具体电路的常数。其中第一部分$\Delta\phi=K_{\mathrm{PM} } f(t)$称为<u>瞬时相偏</u>。

   1. 相位调制时域表达式

      设起始相位为0，则

      $$S_{\mathrm{PM} }(t)=A \cos \left[\omega_{c} t+K_{\mathrm{PM} } f(t)\right]$$

1. 频率调制

   1. 特点：幅度不变，起始相位为0，而**瞬时角频率是调制信号的线性函数**。

   1. 瞬时角频率：$\omega=\omega_{C}+K_{\mathrm{FM} } f(t)$

      式中的$K_{\rm FM}$是频偏常数，第二部分$\Delta\omega=K_{\mathrm{FM} } f(t)$为瞬时频偏。

   1. 频率调制的时域表达式（设初始相位为0）

      由于<u>瞬时角频率换瞬时相位之间互为微分或积分关系</u>，则有

      $$S_{\mathrm{FM} }(t)=A \cos \left[\omega_{C}+K_{\mathrm{FM} } f(t)\right] t$$

      或

      $$S_{\mathrm{FM} }(t)=A \cos \left[\omega_{C} t+K_{\mathrm{FM} } \int_{-\infty}^{t} f(\tau) d\tau\right]$$

      注意⚠：若题目中已知$S_{\rm FM}(t)$的表达式，且形如$S_{\rm FM}(t) = A \cos [\omega_C t + B F(t)]$，则

      1. 频偏常数$K_{\mathrm{FM} }=B$
      1. **调制信号的表达式：$f(t) = F'(t)$，即对$F(t)$<font color="red">求导</font>。**

1. 相位调制和频率调制的单频调制

   考虑单频余弦信号：

   $$f(t)=A_{m} \cos \omega_{m} t$$

   1. 调相

      1. 时域表达式

         $$\begin{aligned} S_{\rm PM}(t) &= A \cos \left[\omega_{C} t+K_{\rm PM} A_{m} \cos \omega_{m} t\right] \\ &= A \cos \left[ \omega_{C}t + \beta_{\rm PM} \cos\omega_{m}t  \right] \end{aligned}$$

      1. 调相指数：$\beta_{\rm PM} = K_{\rm PM} A_m$
         1. 它代表调相波的**最大相位偏移**。
         1. <u>调相指数与调制信号的频率无关</u>。

   1. 调频

      1. 时域表达式：

         $$\begin{aligned}S_{\rm FM}(t) &= A \cos \left[\omega_{C} t+\int_{-\infty}^{t} K_{\rm FM} A_{m} \cos \omega_{m} \tau d \tau\right] \\ &= A \cos \left[\omega_{C} t+\frac{K_{\rm FM} A_{m} }{\omega_{m} } \sin \omega_{m} t\right] \\ &=A \cos \left[\omega_{C} t+\beta_{\rm FM} \sin \omega_{m} t\right] \end{aligned}$$

      1. 调频指数：$\beta_{\rm FM} = \frac{K_{\rm FM}A_m}{\omega_m}$
         1. 它代表**调频波的最大<font color="red">相位</font>偏移**（⚠）
         1. 调频波的最大频率偏移为：$\Delta \omega_{\max }=K_{\rm FM}|f(t)|_{\max }=K_{\rm FM} A_{m}$
         1. 调频指数又等于<u>最大频偏与调制信号角频率之比</u>：$\beta_{\rm FM} = \frac{\Delta\omega_{\max} }{\omega_m}$

   1. 单频调制的特点

      当调制信号的最大幅度$A_m$一定时，使其角频率$\omega_m$增加：

      1. FM中$\Delta \omega_{\max}$不变，而$\beta_{\rm FM}$成反比地减小.
      1. PM中$\beta_{\rm PM}$不变，而$\Delta \omega_{\max}$成正比地增加。

1. 间接调频和调相

   1. 间接调相：先微分，再调频，输出的是调相信号
   1. 简介调频：先积分，再调相，输出的是调频信号
   1. 局限性：仅适用于相偏和频偏不大的窄调制情形。原因是实际相位调制器的调节范围不可超过$(-\pi,\pi)$。

 

## 4.2 窄带角调制

1. 窄带角调制的定义

   1. 区分标准：调制后<u>载波瞬时相移</u>的大小

   1. 窄带角调制的条件

      $$\left|K_{\mathrm{FM} } \int f(t) d t\right|_{\max } \ll \frac{\pi}{6} \quad\text { （调频） }$$

      $$\left| K_{\mathrm{PM} } f(t)\right|_{\max } \ll \frac{\pi}{6} \quad \text{（调相）}$$

1. 窄带调频

   窄带调频与AM的频谱表达式拥有类似的形式，但是又有着原则上的差别：

   1. 频谱：和AM类似，载波+两个边带

   1. 带宽：和AM类似，为调制信号$f(t)$<u>最高频率分量（基带信号带宽）</u>的两倍

   1. 区别：

      1. AM中，载波与上、下边频的合成矢量同相，只发生幅度变化

      1. 窄带调频中，由于**下边频为负**，因而与上边频的合成适量不与再别同相，而是存在相位偏移$\Delta \Phi$。当最大相移满足窄带调频条件时，合成矢量的幅度基本不变。

         <img src="https://vicumi-1300325441.cos.ap-beijing.myqcloud.com/通信原理/[通信原理][4.2]窄带调频频谱图.png" alt="image-20200602121247085" style="zoom:80%;" />

         <img src="https://vicumi-1300325441.cos.ap-beijing.myqcloud.com/通信原理/[通信原理][4.2]窄带调频与AM矢量表示.png" alt="image-20200602121451209" style="zoom:67%;" />

1. 窄带调相

   1. 频谱：类似于AM，载波+两个边带
   1. 带宽：类似于AM，为调制信号$f(t)$<u>最高频率分量（基带信号带宽）</u>的两倍

 

## 4.3 单频信号宽带调频

1. 单频调制时带宽调频信号的频域表达

   利用调频的时域表达式$S_{\rm FM}(t) = A \cos \left[\omega_{C} t+\beta_{\rm FM} \sin \omega_{m} t\right]$。将其用三角公式展开，并再次展开成以贝塞尔函数为系数的三角级数，然后利用**贝塞尔函数**变形可以得到：

   $$S_{\mathrm{FM} }(\omega)=\pi A \sum\limits_{n=-\infty}^{\infty} J_{n}\left(\beta_{\mathrm{FM} }\right)\left[\delta\left(\omega-\omega_{C}-n \omega_{m}\right)+\delta\left(\omega+\omega_{C}+n \omega_{m}\right)\right]$$

   这说明调频信号中：

   1. 频谱中有无穷多个频谱分量；
   1. 其载频分量幅度**正比**于$J_0 (\beta_{\rm FM})$；
   1. 围绕着$\omega_C$的各次方变频分量幅度**正比**于$J_n (\beta_{\rm FM})$。
   1. 至于由贝塞尔函数所决定的调频信号性质，参见教材P72~P73。

1. 单频调制时的频带宽度

   1. 思路：略去高次边频，近似认为具有有限的频谱

   1. **<font color="red"><u>卡森公式</u></font>**

      $$\begin{aligned} B_{\mathrm{FM} } &=2 \Delta f_{\max }\left(1+\frac{1}{\beta_{\mathrm{FM} }}\right) \\ &=2\left(\Delta f_{\max }+f_{m}\right) \\ &=2\left(\beta_{\mathrm{FM} }+1\right) f_{m} \end{aligned}$$

      另外，注意到有关系$\beta_{\rm FM} = \frac{\Delta f_{\max} }{f_m}$。

1. 单频调制时的功率分配

   1. 利用贝塞尔函数的一个性质分析：$\sum\limits_{n=-\infty}^{\infty} J_{n}^{2}\left(\beta_{\mathrm{FM} }\right)=1$

      这说明了：**载频信号中所有频率分量（包括载波）的平均功率之和是常数**，即总功率不变。

   1. 当调制指数$\beta_{\rm FM}=0$时，表示信号未经过调制，此时只有载波功率，其值为$\frac{A^2}{2}$

   1. 当调制指数$\beta_{\rm FM} \neq 0$时，载波功率下降，<u>转变为各边频的功率</u>，而<u>总功率保持不变</u>，始终为$\frac{A^2}{2}$。$\beta_{\rm FM} $的变化反映的是载波和各边频分量功率分配关系的变化。

1. 调频和调相频带利用率比较：调频$>$调相

   因此，PM往往只用于产生FM的一种间接手段：对调制信号先积分再调相。

 

## 4.4 调频（FM）及其解调

1. 调制
   1. 直接法
   1. 倍频法：窄带调频（先积分后调相）+倍频
1. 解调
   1. 非相干解调：鉴频器——适用于所有角度调制信号
   1. 相干解调——<u>只适用于窄带调频信号</u>

## 4.5 调频系统的抗噪声性能

1. 非相干解调的抗噪声性能

   1. 输入信噪比

      输入信号功率：

      $$S_i = \frac{A^2}{2}$$

      输入噪声功率：

      $$N_{i}=n_{0} B_{\mathrm{FM} }$$

      可以得到输入信噪比为

      $$\frac{S_{i} }{N_{i} }=\frac{A^{2} }{2 n_{0} B_{F M} }$$

   1. 输出信噪比

      注意：<u>非相干解调不是线性叠加处理的过程，因而不能分开计算其信号与噪声功率！</u>

      经分析之后，输出信号功率为

      $$S_{o}=\frac{K_{\mathrm{FM} }^{2} }{4 \pi^{2} } \overline{f^{2}(t)}$$

      输出噪声功率为

      $$N_{o}=\int_{-f_{m} }^{f_{m} } \frac{n_{0} f^{2} }{A^{2} } d f=\frac{2 n_{0} f_{m}^{3} }{3 A^{2} }$$

      其中$f_m$为调制信号的截止频率。

      由此可以得到输出信噪比为

      $$\frac{S_{o} }{N_{o} }=\frac{3 A^{2} K_{\mathrm{FM} }^{2} \overline {f^{2}(t)} }{8 \pi^{2} n_{0} f_{m}^{3} }$$

      如果将$\Delta f_{\max }=\frac{1}{2 \pi} K_{\mathrm{FM} }|f(t)|_{\max }$带入上式，则输出信噪比为

      $$\frac{S_{o} }{N_{o} }=3\left(\frac{\Delta f_{\max } }{f_{\mathrm{a} }}\right)^{2} \frac{\overline {f^{2}(t)} }{|f(t)|_{\max }^{2} } \frac{A^{2} / 2}{n_{0} f_{m} }$$

   1. 解调的信噪比增益

      将输出的信噪比除以输入的信噪比，可得信噪比增益为

      $$G_{\mathrm{FM} }=\frac{S_{o} / N_{o} }{S_{i} / N_{i} }=3\left(\frac{\Delta f_{\max} }{f_{m} }\right)^{2} \frac{\overline{f^{2}(t)} }{|f(t)|_{\max }^{2} }\left(\frac{B_{\mathrm{FM} }}{f_{m} }\right)$$

      若$\Delta f_{\max } \gg f_{m}$，则$B_{\mathrm{FM} } = 2(\Delta f_{\max}+f_m) \approx 2 \Delta f_{\max }$，上式可以写成

      $$G_{\mathrm{FM} }=6\left(\frac{A f_{\max } }{f_{m} }\right)^{3} \frac{\overline{f^{2}(t)} }{|f(t)|_{\max }^{2} }$$

      单频信号的情况下，信噪比增益可以写为（更具体地推导请参考教材）

      $$G_{\mathrm{FM} }=3 \beta_{\mathrm{FM} }^{2}\left(\beta_{\mathrm{FM} }+1\right) \approx 3 \beta_{\mathrm{FM} }^{3}$$

   1. 与包络检波地常规调幅AM地抗噪性能对比（大信噪比情况）

      1. 前提：单频调制，接收功率相等，信道噪声的功率谱密度相同。
      1. 调幅AM：$\beta_{\rm AM}=1$，信噪比增益$G_{\rm AM} = \frac{2}{3}$
      1. 输出信噪比对比：$\frac{\left(S_{a} / N_{o}\right)_{\rm FM} }{\left(S_{n} / N_{0}\right)_{\rm AM} } \approx 4.5\left(\frac{B_{\rm FM} }{B_{\mathrm{AM} }}\right)^{2}$
      1. 结论
         1. 宽带调频与调幅信号的输出信噪比之比与它们的带宽比的平方成正比。这说明，对于调频系统来说，<u>增加传输带宽可以改善抗噪声性能</u>。
         1. 在调频指数$\beta_{\rm FM}$较高时，调频系统的输出信噪比远大于调幅系统的输出信噪比——<u>调频系统是用传输带宽换取的信噪比</u>。

1. 调频的小信噪比情况：**<u>门限效应</u>**

   1. $\beta_{\rm FM}$越高，发生门限效应的门限值也越高，转折点以上的输出信噪比改善也越明显。
   1. <u>FM系统以带宽换取输出信噪比改善并不是无止境的</u>。带宽$\uparrow$，$\beta_{\rm FM} \uparrow$，输入噪声功率$\uparrow$。由于输入信号功率不变，所以输入信噪比$\downarrow$。当输入信噪比恶化到一定的程度时，就会发生门限效应。

1. 相干解调的抗噪声性能：略

### 不同模拟调制方式的比较

1. 比较表格

   表格中，FM的调幅指数$m_f$即为前文中的$\beta_{\rm FM}$。各调制方式的输出信噪比反映的是与输入信号功率的数量关系。

   <img src="https://vicumi-1300325441.cos.ap-beijing.myqcloud.com/通信原理/[通信原理][4.5]模拟调制方式性能对比表.png" alt="image-20200602201226434" style="zoom:80%;" />

1. 抗噪声性能对比

   图像中，FM的曲线画了两条，使用了不同的调幅指数$\beta_{\rm FM}$（即$m_f$）。

   结论：FM$>$DSB/SSB$\approx$VSB$>$AM

   再次强调：FM的抗噪声性能使用更宽的带宽换来的。

   <img src="https://vicumi-1300325441.cos.ap-beijing.myqcloud.com/通信原理/[通信原理][4.5]模拟调制的抗噪声性能.png" alt="image-20200602201607924" style="zoom:67%;" />

 

## 4.6 预加重/去加重技术

1. 使用预加重/去加重的原因

   1. 信号频谱大部分集中在低频段
   1. 噪声功率谱密度与调制信号的平方成正比，随着频率的增加而急剧增大，这将导致输出信噪比下降。

1. 预加重和去加重

   1. 预加重：发送端提高输入信号的高频分量
   1. 去加重：接收端解调后压低信号高频分量

1. 预加重和去加重网络

   1. 两各网络的关系频域上互补：$H_1 (f) H_2 (t) = 1 \quad \text{（或常数）}$

   1. 加重改善系数：用于衡量系统加重后对噪声性能的改善程度，表示为$I_{\omega}=\frac{加重后的输出信噪比{\rm SNR}_o}{不加重的输出信噪比{\rm SNR}'_o}$

      由于$S_o = S'_o$，因此$I_{\omega} = \frac{N_o}{N'_o}$。

   1. 衰减因子：用于保持预加重后频偏不变。

      原因：提升高频分量，将使得最大频偏增大，从而超出信道所容许的频带宽度。

      方法：衰减一些信号的幅度。

   1. 网络要求

      1. 预加重：高通滤波器
      1. 去加重：低通滤波器

 

## 4.7 压扩技术

作用

+ 改善小信号的输出信噪比
+ 改善门限效应

 

 

# 第五章 脉冲编码调制

## 一、基本原理

### 5.1 脉冲编码调制（PCM）的基本原理

1. 脉冲编码调制：一种“模拟语音信号$\rightarrow$数字信号”的编码方式

1. 属于信源编码

1. **<u>PCM的主要过程：抽样$\rightarrow$量化$\rightarrow$编码</u>**

   1. 抽样：连续时间$\rightarrow$离散时间
   1. 量化：连续幅度$\rightarrow$离散幅度
   1. 编码：量化后的信号$\rightarrow$二进制码组输出

1. PCM过程说明

   1. 预滤波：限制频带（以达到标准的频带内）
   1. 重建低通滤波器：从频率响应方面补偿抽样保持电路引入的频率失真
   1. 重建信号失真的原因
      1. 量化误差
      1. 信道噪声引起的误码
   1. PCM过程方框图

   <img src="https://vicumi-1300325441.cos.ap-beijing.myqcloud.com/通信原理/[通信原理][5.1]PCM原理图.png" alt="image-20200607001216652" style="zoom:67%;" />

 

## 二、抽样

### 5.2 低通与带通抽样定理

1.  <font color='red'>**低通抽样定理（奈奎斯特采样定理）**</font>

   1. **定理内容**：一个频带限制在$(0,f_H)$内的连续信号，如果抽样频率$f_s \geq 2f_H$（或$\omega_s \geq 2 \omega_H$），则由抽样序列可以无失真地重建恢复原始信号。
   1. 混叠失真：当$f_s < 2f_H$（或$\omega_s < 2 \omega_H$）时，发生**混叠失真**。
   1. 抽样对信号的影响：原信号频谱以**抽样速率为周期**进行**周期延拓**。

1. 内插公式

   1. 概念：用<u>时域</u>表达重建信号的公式。

   1. 频域表达式（作为推导条件）：$X_{s o}(\omega)=X(\omega) H(\omega) / T_s \ (|\omega| < \omega_H)$（注意幅度上变化，除以了一个$T_s$）

   1. 时域表达式

      $$\begin{align} \hat{x}(t) &= h(t) * x_s (t) \\ &=\frac{1}{T_{\mathrm{S} }} \sum_{n=-\infty}^{+\infty} x\left(n T_{S}\right) \frac{\sin \omega_{H}\left(t-n T_{S}\right)}{\omega_{H}\left(t-n T_{S}\right)} \end{align}$$

      核函数：$\frac{\sin \omega_{H}t}{\omega_{H}t}$

      解读：<u>任何一个窄带信号（窄带函数）都可以展开为核函数的线性叠加</u>。（类似于傅里叶级数、泰勒级数展开）

   1. 图示例子

      <img src="https://vicumi-1300325441.cos.ap-beijing.myqcloud.com/通信原理/[通信原理][5.2]内插公式重建.png" alt="image-20200610084210764" style="zoom: 60%;" />

1.  **<font color='red'>带通抽样定理</font>**

   1. **定理内容**：一个频带限制在$(f_L,f_H)$内的连续带通信号，要使得抽样信号能够无失真地重建恢复原始信号，抽样频率应该满足如下条件：

      $$f_{s}=2\left(f_{H}-f_{L}\right)\left(1+\frac{M}{N}\right)=2 B\left(1+\frac{M}{N}\right)$$

      其中，

      $$\begin{cases} B = f_H - f_L \\ M = \frac{f_H}{B}-N \\ N = [\frac{f_H}{B}] \end{cases}$$

      根据上式绘制出相应的曲线图（此处略，见教材），带通信号的<u>抽样频率在$2B$到$4B$范围</u>变动。

   1. 理解分析

      1. 信号的抽样频谱表达式：$X_{s}(\omega)=\frac{1}{T_{s} } \sum_{n=-\infty}^{+\infty} X\left(\omega-n \omega_{s}\right)$

         再次强调：是原信号频谱以抽样速率为周期的周期延拓。只不过带通信号同时有上边带和下边带，两边都有同时平移。

      1. 示例：$f_H = 3B, \ f_s = 2B$，第二幅图是左移$2B$，第三幅图是右移$2B$，把所有平移后的（原始的也算）都叠加即得抽样信号频谱。

         <img src="https://vicumi-1300325441.cos.ap-beijing.myqcloud.com/通信原理/[通信原理][5.2]带通抽样示例.png" alt="image-20200610091657436" style="zoom:67%;" />

 

### 5.3 实际抽样

1. 自然抽样

   抽样脉冲序列$c(t)=\sum_{x=-\infty}^{\infty} p\left(t-n T_{s}\right)$，其中$p(t)$是任意形状的脉冲。自然抽样时，抽样过程实际上是**相乘过程**。

1. 平顶抽样

   1. 每个抽样脉冲顶部不随信号变化（自然采样顶部不平）。

   1. 平顶抽样=理想抽样+冲激响应是矩形的网络

   1. **孔径失真**：抽样后信号频谱不仅扩展，而且引入了频谱失真项$\frac{\sin (\omega \tau / 2)}{\omega \tau / 2}$

      通常取$\tau=T_s$以得到<u>最大输出信号</u>。

      接收端必须使用频谱响应为失真项倒数，即$\frac{\omega \tau / 2}{\sin (\omega \tau / 2)}$滤波器进行频谱补偿，以抵消孔径失真。

 

## 三、量化

### 5.4 标量量化与矢量量化

量化——幅度离散化

1. 标量量化

   1. 分层电平（判决阈值）：$x_k$

   1. 重建电平（量化电平）：$y_k$，数量为$L$

   1. 量化间隔：$\Delta_k=k_{k+1} - x_k$

   1. 量化误差：$q$

   1. 量化噪声：$\sigma_q ^2$，一般用均方误差来度量。

      $\sigma_q ^2$与<u>量化间隔的分割</u>有关。

   1. 最佳量化器：给定输入信号概率密度$p_x (x)$和$L$，求一组${x_k}$与${y_k}$，使得量化噪声最小。

1. 矢量量化

   1. 输入：连续幅度的随机矢量（$N$维）：$\bar{x}$
   1. 输出：离散的幅度矢量：$\bar{y}$
      1. 重建码本（码本）：$\{\bar{y_i}\} \ (1 \leq i \leq L)$
      1. 码本尺度：$L$
   1. 最佳量化条件
      1. 条件一：选出失真最小（距离最近）的矢量
      1. 条件二：Voroni子空间法

1. 矢量量化比标量量化更接近率失真函数的界值$D(R)$。

 

### 5.5 最佳量化器

1. 达到最佳量化的要求

   1. 分层电平应在相邻重建电平的中点
   1. 重建电平应取在量化间隔的质心上

1. 求解方法

   1. $L=2$：解析法
   1. $L \gg 2$：变分法求近似解
   1. $4 \leq L \leq 16$：迭代法求数值解

1. 量化器噪声（这个计算虽然复杂，但是在作业题中出现过）

   1. 不过载

      $$\sigma_{q}^{2}=\frac{1}{12} \int_{-V}^{V}\left(\Delta_{k}\right)^{2} p_{x}(x) d x$$

   1. 过载

      $$\sigma_{qo}^{2}=\int_{V}^{\infty}(x-V)^{2} p_{x}(x) d x+\int_{-\infty}^{-V}(x+V)^{2} p_{x}(x) d x$$

   1. 总的量化噪声 = 不过载噪声 + 过载噪声

      $$\sigma_{qs}^{2}=\sigma_{q}^{2}+\sigma_{qo}^{2}$$

 

### 5.6 均匀量化

1. 只有在信号是均匀分布的情况下，均匀量化器才是最佳量化器。

1. 量化噪声

   1. 量化范围：$(-V,+V)$

   1. 量化间隔：$\Delta_k = \Delta = \frac{2V}{L}$

   1. 当信号**不过载**时，有$\sum_\limits{k=1}^{L} P_{k}=1$

   1. **不过载时的量化噪声**

      $$\sigma_{q}^{2}=\frac{\Delta^{2} }{12}=\frac{V^{2} }{3 L^{2} }$$

   1. 均匀量化的<u>不过载量化噪声功率与信号的统计特性无关</u>。

1. 不同信号的均匀量化信噪比

   设量化间隔数$L=2^n$，则$n = \log_2 L$。信号幅度的归一化有效值为$D=\frac{\text{信号有效值} }{最大量化电平值}$

   1. 均匀分布信号：$SNR_{\rm dB} \approx 20 \lg D + 6.02n$
   1. 正弦信号：设幅度为$A_m$，则功率为$S = A_m^2 / 2$
      1. y一般形式：$SNR_{\rm dB} \approx 4.77 + 20 \lg D + 6.02n$
      1. 当$A_m = V$时，信号幅度的归一化有效值为$D = \frac{1}{\sqrt{2} }$，则满载正弦波的信噪比为：$SNR_{\rm dB} = 6.02n + 1.76$
   1. 实际语音信号
      1. 动态范围：满足$SNR \geq SNR_{\rm min}$的信号功率范围。
      1. 小过载：$SNR_{\rm dB} \approx 4.77 + 20 \lg D + 6.02n$
      1. 大过载：$SNR_{\rm dB} \approx \frac{6.1}{D}$
   1. 总结
      1. **量化信噪比随量化电平数$L$的增加而提高。**
      1. **每增加一位编码，量化层数$L$翻倍，量化信噪比提高6dB。**

 

### 5.7 最佳非均匀量化

1. 非均匀量化：量化间隔不相等
1. 非均匀量化的方法
   1. 非线性变换+均匀量化+编码（理论）
   1. 瞬时压缩和瞬时扩张（实际）

### 5.8 对数量化及其折线近似

1. 理想对数量化

1. A律对数压缩特性：A$\uparrow$，压缩效果$\uparrow$

1. $\mu$律对数压缩特性：$\mu \uparrow$，压缩效果$\uparrow$

1. 对数压缩特性的折线近似

   1. A律13折线

      输入信号为正时，有8条折线，由于第一、第二段折线斜率相等，所以实际上共有7条折线。如果加上负信号，则共有4段折线斜率相似，所以实际上共有13段折线。

   1. $\mu$律15折线

      计算原理和A律近似。

 

## 四、编码

### 5.9 PCM编码原理

1. 常用二进制码组

   1. 自然二进制码组（NBC）
   1. **折叠二进制码组（FBC）**
      1. 左边第一位表示正负号，第二位开始至最后一位表示幅度。
      1. “1”表示正，“0”表示负。
      1. 失真误差功率在三者中最小，所以是PCM标准。
   1. 格雷二进制码组（RBC）

1. 信道误码对信噪比的影响

   小信号时，折叠码的SNR笔触自然码要高。

1. PCM编码规则

   1. 原理：逐次比较法

   1. **<font color='red'>8位码的编码规则</font>**

      1. 编码排列

         <img src="https://vicumi-1300325441.cos.ap-beijing.myqcloud.com/通信原理/[通信原理][5.9]PCM8位码.png" alt="image-20200610122054554" style="zoom:50%;" />

      1. 说明

         1. 极性码：“1”为正，“0”为负

         1. 段落码：共可以表示8段，A律13折线中，000和001共同表示第一段。因此，$M_2 M_3 M_4$代表的是**8个段落的起始电平值**。

         1. 电平码：确定好了段落之后，段落内的16个量化电平值。设输入信号电平为$x\Delta_k$，在第$k$段内，则$$(M_5 M_6 M_7 M_8)_2 = (\lfloor \frac{x\Delta-\text{所在段的起始电平} }{\text{第}k\text{段的量化间隔}\Delta_k} \rfloor)_{10} $$

         4. 编码对照表（实际上，$\delta$那两栏没用）

            <img src="https://vicumi-1300325441.cos.ap-beijing.myqcloud.com/通信原理/[通信原理][5.9]PCM8位码编码对照表.png" alt="image-20200610123117710" style="zoom: 67%;" />

      1. 特点

         1. 每段内的量化电平值是等间隔分布的。
         1. 量化间隔大小随段落序号的增加呈2倍递增（从第二段开始，段落编号每加1，量化间隔就乘以2）

      1. <font color='red'>实际<u>译码</u>输出的量化电平值=段落码的起始电平值+码字电平值+$\frac{\Delta_k}{2}$（注意不是$\Delta$）</font>

      1. 例题

         <img src="https://vicumi-1300325441.cos.ap-beijing.myqcloud.com/通信原理/[通信原理][5.9]PCM编码例题1.png" alt="image-20200610142955192" style="zoom: 80%;" />\

 

### 5.10 对数PCM编码与线性PCM编码之间的变换

1. 线性PCM = 均匀量化+折叠码——可直接进行二进制计算，便于计算机处理

1. A律PCM码与线性PCM之间的关系（查表）

   <img src="https://vicumi-1300325441.cos.ap-beijing.myqcloud.com/通信原理/[通信原理][5.10]A律PCM和线性PCM对照表.png" alt="image-20200610145034546" style="zoom:80%;" />

1. 例题

   <img src="https://vicumi-1300325441.cos.ap-beijing.myqcloud.com/通信原理/[通信原理][5.10]PCM编码例题2.png" alt="image-20200610145834972" style="zoom:80%;" />

 

 

# 第九章 数字基带的传输

 

## 引言
1. 数字基带信号
未经调制的电脉冲信号所占据的频带通常从直流和低频开始，称为**数字基带信号**。
1. 基带传输和调制传输
  1. 基带传输：直接传送信号
  1. 调制传输（载波传输）：频谱搬移后传输

## 9.1 数字基带信号的码型
1. 码型的设计原则
提几个要点：
      1. 无直流分量，低频分量少
      1. 高频分量少，以**减少传输频带**和**码间串扰**
      1. 适应信源变化
      1. 具有**定时信息**
      1. 具有内在的检错能力
      1. **误码增殖**少
      1. 有分组同步信息
      1. 编译码设备尽量简单
      1. ...

1. 二元码、三元码和多元码
     * 依据：每个码元的<u>幅度取值</u>，不是进制

1. 常用的二元码
      1. 单极性不归零码（NRZ）——1和0
      1. 双极性不归零码——+1和-1
      1. 单极性归零码（RZ）
      1. 双极性归零码
        * 自同步
      1. 差分码
        * “1”差分码：极性改变表示1，不变表示0
        * “0”差分码：极性改变表示0，不变表示1
        * 一般是用的“1”差分码
      1. 一组两位码（1B2B）
        * 一位有效信息，使用两位传输

  1. 数字双向码（曼彻斯特码） 
        使用**一个周期**的方波表示1，而用它反向的波形表示0：
        “正负”：1，“负正”：0

  5. 传号反转码

  3. 密勒码（数字双向码的一种变形）

    * 1B2B码：
        * 优势：实现简单，性能好
        * 劣势： 需要用**2倍**的资源，有效性$\downarrow$

1. 三元码

    * 注意：是幅度的取值有**3个（-1，0，+1）**，不是三进制！

  1. 信号交替反转码（AMI）

     * “1”交替变换成+1和-1的归零码

  2. HDB$n$码
        1. “1”码：交替变换成+1和-1的归零码（同AMI）
        1. “0”码：
            1. 连续的“0”的数量被限制为$\leq n$
            1. 当信息中出现连续$n+1$个“0”码时使用特定的码组来替代——取代节

  3. HDB3码
      1. 每出现4个连续的“0”时用取代节`B00V`和`000V`代替
      1. 替代原则
      ![image-20200504192648891](https://vicumi-1300325441.cos.ap-beijing.myqcloud.com/通信原理/[通信原理]HDB3码示意.png)

  1. 编码效率
   $$\eta = \frac{C_B}{C_C}$$
  其中$\eta$为编码效率，$C_B$为二进制信码的信息容量，$C_C$为传输码型的最大可能信息容量。

1. 多元码
&nbsp;&nbsp;&nbsp;&nbsp;对于$n$位的二进制信号来说，可以使用$M=2^n$元码来传输。与二元码传输相比，$M$元码传输时所需要的信道可以降为$\frac{1}{n}$，即频带利用率提高为$n$倍。
    * 通常用**格雷码**表示

 

## 9.2 数字基带信号的功率谱计算

1. 相同波形随机序列的功率谱

   1. 相同波形随机序列的表示

      $$S(t) = \sum\limits_{n=-\infty}^{\infty} a_n g(t-nT_s)$$

   1. 性质

      1. 广义平稳
         1. 随机过程的$n$维概率密度不随时间起点选择的不同而改变

         1. 均值为常数，相关函数只与时间间隔有关且平方均值有限的随即过程

         1. 编码后的基带信号是以$T_s$为周期的周期函数，称为广义周期随机平稳过程

         1. 一般情况下的数字基带信号不是广义平稳的，但是可以假设信号是**各态历经性**的
对于一个平稳随机过程，如果统计平均 = 时间平均值， 则称为个态历经的平稳随机过程
      2. 平均功率谱
         （以下两个例子见教材P208-P209）
         1. 单极性二元码的功率谱密度
         2. AMI码的功率谱密度

2. 一般情况下的随机序列功率谱

   1. 一般情况下随机序列的表示

      $$S(t) = \sum\limits_{n=-\infty}^{\infty} S_{n}(t-nT_s)$$

      其中$S_n(t) \in \{g_i(t); i=1,2,...,N\}$，有$N$种不同的信号源可以选择。假设$N=2$，则

      $$S_n(t)=\begin{cases}g_1(t-nT_s)&&\text{p}\\g_2(t-nT_s)&&\text{1-p}\end{cases}$$

   2. 连续功率谱密度

      1. 连续谱——决定信号的带宽

         $$P_{u}(f)=f_{s}P(1-P)|G_{1}(f)-G_{2}(f)|^2$$

      2. 离散谱——决定信号是否有直流和定时分量

         $$P_{v}(f)=f_{s}^{2}\sum\limits_{n=-\infty}^{\infty} |PG_{1}(nf_{s})+(1-P)G_{2}(nf_{s})|^{2}\delta(f-nf_{s})$$

         当离散谱**不存在**时，就意味着没有$f_s$成分，位同步就无法提取。

         离散谱是否存在取决于信号的波形和出现的概率。

      3. 总功率谱

         $$\mathscr{P}(f)=\frac{1}{T_s^2}\sum\limits_{n=-\infty}^{\infty}|PG_1(\frac{n}{T_s})+(1-P)G_2(\frac{n}{T_s})|^{2}\delta(f-\frac{n}{T_s}) + \frac{1}{T_s^2}P(1-P)|G_1(f)-G_2(f)|^2$$

         其中，第一部分为离散谱，第二部分为连续谱。

3. 结论

   1. 随机序列带宽：选取频谱$G_1(t)$和$G_2(t)$中带宽较大的。

   1. 时间波形的占空比越小，频带越宽。通常以频谱的第一个零点当作矩形脉冲的近似带宽，即$B_s = \frac{1}{\tau}$，其中$\tau$为脉宽。

      1. 不归零脉冲：$\tau=T_b,B_s=f_b$
      1. 半占空归零脉冲：$\tau=\frac{T_b}{2},B_s=2f_b$
      1. $f_b$是位定时信号的频率，数值上等于码速率$R_B$

   1. 单极性基带信号是否存在离散线谱取决于矩形脉冲的占空比

      | 单极性归零信号 |     单极性不归零信号     |
      | :------------: | :----------------------: |
      |   有定时分量   |        无定时分量        |
      |  可以直接提取  | 无法直接提取，需波形变换 |

 

## 9.3 波形传输的无失真条件

&nbsp; &nbsp;引入

+ 能量有限的矩形脉冲信号

  + 频谱随着$\omega$的增加而增加
  + **有限时宽$\rightarrow$无限频宽**
  + 第一个频谱零点$B=\frac{2\pi}{\tau}$
  + 偶函数（对称性）

+ 码间串扰——叠加的噪声干扰和传输波形失真

+ **只要在$t_0 + T_s$，$t_0 + 2T_s$等后面码元的抽样判决时刻上正好为0**，就能实现码间串扰。如图所示。

  ![image-20200416183844636](https://vicumi-1300325441.cos.ap-beijing.myqcloud.com/通信原理/[通信原理码间串扰的避免].png)

1. 奈奎斯特第一准则——抽样点无失真

   1. 无码间串扰的<u>时域</u>条件

      $$h(KT_s)=h_0 \delta(t)$$

      其中，$T_s$为冲激脉冲间隔，符号速率为$\frac{1}{T_s}$

      <img src="https://vicumi-1300325441.cos.ap-beijing.myqcloud.com/通信原理/[通信原理]无码间串扰时域.png" alt="image-20200416185546660" style="zoom:50%;" />

   2. 无码间串扰的<u>频域</u>条件

      $$\sum\limits_{i} = H(\omega+\frac{2i\pi}{T_s})=T_s\qquad |\omega|\leq\frac{\pi}{T_s}$$

      或

      $$\sum\limits_{i} = H(f+\frac{i}{T_s})=T_s\qquad |f|\leq\frac{1}{2T_s}$$

      + 物理含义：
          + **切割：（以$\frac{2\pi}{T_s}$为间隔）**
          + **平移：到区间$(-\frac{\pi}{T_s},\frac{\pi}{T_s})$内**
          + **叠加：结果应该为一个<u>常数</u>**
      + 在$(-\frac{\pi}{T_s},\frac{\pi}{T_s})$区间内**等效为理想LPF**，无码间串扰
      + 设滤波器的带宽为$W$，码元速率$R_B = \frac{1}{T_s}$，则
          + $R_B > 2W$：不满足
          + $R_B = 2W$：有**唯一**可能的传递函数$h(t)=Sa(\frac{\pi t}{T_s})$，频谱$H(f)=T_s(|f|\leq W=\frac{\pi}{T_s})$
          + $R_B < 2W$：**有可能**满足（思考：为什么？），即只有一些特定值满足
            **<u>考察方式</u>**：$2f_{H}T_{s}=K$，$K$为整数，$f_H$为理想低通滤波器的截止频率

   3. 无码间串扰的基带传输系统设计

      1. 理想低通特性（极限情况）
         1. 传递函数$h(t)=Sa(\frac{\pi t}{T_s})$，频谱$H(f)=T_s(|f|\leq W=\frac{\pi}{T_s})$
         2. 系统带宽：$B=\frac{\pi}{T_s} {\rm (rad)}$或$B=\frac{1}{2T_s} {\rm Hz}$。若$R_B=2B=\frac{1}{T_s}$则不存在码间串扰，若$R_B>2B=\frac{1}{T_s}$则存在码间串扰。
            $B=\frac{1}{2T_s}$(Hz)称为**奈奎斯特带宽**，$R_B=\frac{1}{T_s}$称为**奈奎斯特速率**，$T_s$称为**奈奎斯特间隔**。
         3. **最高频带利用率**
              1. **二进制：$\eta = \frac{R_B}{B}=2 {\rm Bd/Hz}$**
              2. **$M$进制：$\eta = \frac{R_b}{B}=\frac{R_B {\rm log}_2 M}{B} = 2{\rm log}_2 M {\rm (bits/s \cdot Hz)}$**

      2. 升余弦滚降特性

         1. 描述：以$\frac{\pi}{T_s}$为中心，具有奇对称升余弦形状过渡带

         2. 滚降系数：$\alpha \in [0,1]$

            1. $\alpha=0$时：理想低通传输特性，系统带宽<u>最小</u>，$\eta=2{\rm Bd/Hz}$，时域尾部衰减<u>最慢</u>
            2. $\alpha=1$时：全滚降升余弦特性，系统带宽<u>最大</u>，$\eta=1{\rm Bd/Hz}$，时域尾部衰减<u>最快</u>
            3. $\alpha \uparrow$，$h(t)$拖尾衰减速度$\uparrow$

         3. 等效的理想低通特性
            如下图的升余弦型系统，其等效的理想低通滤波器的截止频率$f_{N} = \frac{1}{2}f_{H}$

            ![image-20200416202301866](https://vicumi-1300325441.cos.ap-beijing.myqcloud.com/通信原理/[通信原理]升余弦型系统.png)

         4. 参数计算

            1. 带宽：$B = W + \Delta f = (1+\alpha)W$，$W$为单边带带宽
            2. 频带利用率：$\eta = \frac{R_B}{B} = \frac{2W}{(1+\alpha)W} = \frac{2}{1+\alpha} {\rm Bd/Hz}$

 

## 9.4 部分相应基带传输系统

1. 部分相应波形

   1. 问题的提出

      1. 理想低通滤波器，即传递函数为${\rm Sa}(x)$函数的缺点
         1. 频谱为矩形，过渡带为0，物理不可实现
         1. 时域波形拖尾衰减慢
      1. 升余弦滚降：频带利用率有损失

   1. 设计目标

      1. 物理可实现
      1. 频域滚降
      1. 时域拖尾衰减快
      1. 频带利用率能达到最高的2Bd/Hz

   1. 第一类部分响应系统

      ![image-20200427083957836](https://vicumi-1300325441.cos.ap-beijing.myqcloud.com/通信原理/[通信原理]第一类部分响应系统波形.png)

      1. 构成方式：使用相隔一个码元间隔$T_{s}$的${\rm Sa}(x) = \frac{ {\rm sin}x}{x}$的合成波形$S(t)$

         $$S(t) = \frac{4}{\pi}[\frac{ {\rm cos}(\frac{\pi t}{T_s})}{1-\frac{4t^2}{T_{s}^2} }]$$

      1. 结果：拖尾衰减加快

         原因：相距一个码元间隔的${\rm Sa}(x)$的拖尾极性相反，正好抵消。

         **拖尾速率对比**：由波形的表达式可知，$S(t)$的拖尾随时间以$t^{2}$的速度衰减，而${\rm Sa}(x)$以$t$的速度衰减。

      1. 参数计算

         1. 带宽：$B = \frac{1}{2T_s} {\rm Hz}$
         1. 频带利用率：$\eta = \frac{R_B}{B} = 2 {\rm Bd/Hz}$

      1. 系统特点

         1. 优点：**串扰可控，仍可以按照$\frac{1}{T_s}$的传输速率传送码元**。系统将${\rm Sa}(x)$信号延时$T_s$相加即可。
         1. 不足：第一类部分响应信号是以相邻码元抽样时刻出现与发送码元抽样值幅值相同的串扰作为代价的——存在固定的幅度串扰，使得部分响应序列中出现新的抽样值。

   1. 第四类部分响应系统

      + 优点：低频分量小，无直流分量，便于边带滤波。实际应用更广泛。

      <img src="https://vicumi-1300325441.cos.ap-beijing.myqcloud.com/通信原理/[通信原理]第四类部分响应系统.png" alt="image-20200427085306710" style="zoom:67%;" />

1. 部分响应基带传输系统的相关编码与预编码

   1. 相关编码

      1. 一般形式：部分响应信号的当前抽样值$c_n$和其他信码的串扰值有关，其波形表达式为

         $$c_n = r_0 a_n + r_1 a_{n-1} + r_2 a_{n-2} + ... + r_N a_{n-N}$$

         其中$r_k$为加权系数，记载于固定的表格中（和部分响应波形的种类有关，此处从略）。

         以第一类响应信号为例，其波形表达式为$c_n = a_n + a_{n-1}$，接收端恢复恢复时作计算：$a_n = c_n -a_{n-1}$即可。

      1. **差错传播**

         在传输过程中，$\{c_n\}$序列中的某个抽样值因干扰而产生差错，则不但会造成当前的$a_n$恢复错误，而且会影响到以后所有的$a_{n+1}, a_{n+2},...$等抽样值。

         解决方法：预编码

   1. 预编码

      1. 编码方法：

         1. 在发送端相关编码之前先进行预编码（L进制）：$a_n = r_0 b_n + r_1 b_{n-1} + r_2 b_{n-2} + ... + r_N b_{n-N} \quad ({\rm mod}\ L)$
         1. 再进行相关编码：$c_n = r_0 b_n + r_1 b_{n-1} + r_2 b_{n-2} + ... + r_N b_{n-N} $
         1. 恢复（模2判决）：$a_n = c_n({\rm mod}\ L)$

      1. 物理意义：预编码之后的部分响应信号各抽样值之间已解除了相关性

      1. 举例

         | 信号种类 | 第一类部分响应信号                        | 第四类部分响应信号                        |
         | -------- | ----------------------------------------- | ----------------------------------------- |
         | 预编码   | $b_n = a_n - b_{n-1}\quad ({\rm mod}\ 2)$ | $b_n = a_n + b_{n-2}\quad ({\rm mod}\ 4)$ |
         | 相关编码 | $c_n = b_n + b_{n-1}$                     | $c_n = b_n - b_{n-2}$                     |
         | 解码恢复 | $a_n = c_n ({\rm mod}\ 2)$                | $a_n = c_n ({\rm mod}\ 4)$                |

         编码系统（第四类部分响应系统）

         ![image-20200427093020135](https://vicumi-1300325441.cos.ap-beijing.myqcloud.com/通信原理/[通信原理][CH9]预编码和相关编码系统_第四类.png)

 

## 9.5 数字信号基带传输的差错率

&nbsp;&nbsp;前提：

+ 不考虑码间干扰

+ 信道噪声为均值等于0的加性高斯白噪声（AWGN），记为$n(t)$

1. 二元码的误比特率

   1. 定义

      考虑单极性NRZ二元码的误码率。在无码间干扰时，在抽样时刻$t=KT_s$有：

      $$r(KT_s) = A + n(KT_s) \quad \text{码1}$$

      $$r(KT_s) = n(KT_s) \quad \text{码0}$$

      设定判决门限为$d$，则$r(KT_s)>d$时判决为1，$r(KT_s)<d$时判决为0。在叠加噪声后二元码幅度的概率密度函数如下图。

      ![image-20200429212526777](https://vicumi-1300325441.cos.ap-beijing.myqcloud.com/通信原理/[通信原理][9.5]二元码加噪声的概率分布.png)

   1. 误比特率

      1. 二元码的误比特率（$Q$函数）

         $$P_b = \int_{\frac{d}{\sigma} }^{\infty}\frac{1}{2\pi}e^{-\frac{x^2}{2} }dx = Q(\frac{d}{\sigma})$$

      1. 单极性NRZ码

         抽样幅度为0和$A$，平均信号功率为$S=\frac{A^2}{2}$，噪声平均功率$N=\sigma^2$，误比特率

         $$P_b = Q(\sqrt{\frac{S}{2N} })$$

      1. 双极性NRZ码

         抽样幅度为$\pm \frac{A}{2}$，平均信号功率为$S=\frac{A^2}{4}$，噪声平均功率$N=\sigma^2$，误比特率

         $$P_b = Q(\sqrt{\frac{S}{N} })$$

      1. 分析

         1. 相同的误比特率$P_b$的情况下，单极性二元码的平均信号功率是双极性二元码的2倍——要获得相同的误比特率，单极性二元码的信噪比需要比双极性二元码**高3dB**。
         1. **信噪比相同时，双极性二元码的误比特率高于单极性二元码。**
         1. **双极性二元码的判决门限为0**，应用更广。

1. 三元码和多元码的差错率（注意误符号率、误码率的区别）

   1. 三元码

      1. 参数

         1. 幅度：$-A$、$0$、$+A$
         1. 最佳判决电平：$\pm \frac{A}{2}$，假设三种电平出现的概率**相等**
         1. 信号功率：$S = \frac{2}{3}A^2$
         1. 误比特率：$P_b = \frac{4}{3}Q[\sqrt{\frac{3}{8}(\frac{S}{N})}]$（注：书上的$Q$函数没有$\frac{4}{3}$系数）

      1. 注意事项

         在AMI码中，三种码元出现的概率**不相等**，$-A$、$0$、$+A$，三种幅度的电平出现的概率分别为$\frac{1}{4}$、$\frac{1}{2}$、$\frac{1}{4}$，因此判决门限应满足$d_{1}>\frac{A}{2}$、$d_{2}<-\frac{A}{2}$，总比特率$P_b$也必然不同。

   1. M元码

      1. 对于$n$位二进制码组来说，可以使用$M=2^n$元码来传输。
      1. 与二元码相比，$M$元码传输时所需的**信道频带可以降为$\frac{1}{ {\rm log}_2M}=\frac{1}{n}$**
      1. 随着$M$的增加，保持相同的误码率所需的**信号功率也会增大**，否则误码率会降低。

   1. 部分响应基带信号

   1. 误符号率与误比特率的关系

      1. 自然码：$\frac{1}{2}<\frac{P_b}{P_s}\leq\frac{2}{3}$
      1. 格雷码：$P_b \approx \frac{1}{n}P_s$
      1. 误比特率小于误符号率

1. 基带传输差错率分析

   1. 误符号率/误码率 vs 误比特率/误信律

      先求误码率，再求误比特率。

   1. <u>本质：误码率由$\frac{A}{\sigma}$（归一化相邻符号间隔）决定</u>。

      高进制调制误码性能比低进制调制差，但频带利用率高。

 

## 9.6 扰码和解扰

&nbsp;&nbsp;引言

+ 扰码——使数字系统（基带/通带）对各种数字信息具有透明性
  + 改善位定时恢复的质量
  + 使信号弥散而保持稳恒，能改善帧同步和自适应时域均衡等子系统的性能
  + 这种扰乱是人为的、有规律的，因而是可以解除的
+ 解扰——解除扰码

1. m序列的产生的性质

   1. 概念：最长线性反馈移位寄存器序列

   1. 特点：具有最长周期

   1. 一般情况下的$n$级线性反馈移位寄存器

      ![image-20200504202257143](https://vicumi-1300325441.cos.ap-beijing.myqcloud.com/通信原理/[通信原理][9.6]n级线性反馈移位寄存器.png)

      逻辑表达式为

      $$a_n = C_{1}a_{n-1} \oplus C_{2}a_{n-1} \oplus \cdots \oplus C_{n}a_0 = \sum\limits_{i=1}^{n}C_{i}a_{n-i} \quad\text{（模二加）}$$

      其中$C_i = 1$表示反馈线接通，$C_i = 0$表示反馈线断开。将式中的$a_n$移至等式的右边，有

      $$0=\sum\limits_{i=0}^{n}C_{i}a_{n-i}$$

      则可以定义一个对应的多项式为

      $$F(x) = \sum\limits_{i=0}^{n}C_{i}x^{i}$$

      将此式称之为线性反馈移位寄存器的**特征多项式**。

   1. 特征多项式$F(x)$——是$n$次**本原多项式**

      1. $F(x)$是既约多项式，级不能再分解因式
      1. $F(x)$可以整除$x^m + 1$，这里$m=2^n -1$，$m$的值也是**m序列的周期**
      1. $F(x)$不能整除$x^q + 1$，这里$q<m$
      1. 注意：这里的乘除法都是模二意义上的乘除法

   1. m序列的性质

      1. $n$级移位寄存器，产生的m序列的周期为$2^n -1$

      1. 除全0状态外，其他状态都在m序列的**一个周期内出现而且只出现一次**。由此可知，m序列中1和0出现的概率大致相同，**1比0多一个**。

      1. m序列的自相关函数只有两种取值。将0和1分别取值为-1和+1，**其自相关函数在对齐时值为$2^n - 1$，而在其他非0移位时恒为-1**。这里的自相关函数定义为$\rho(i)=A-B$。其中$A$为序列与其$i$次移位序列在一个周期内逐位码元相同的数目，$B$为序列与其$i$次移位序列在一个周期内逐位码元不同的数目。

         ![image-20200504205022750](https://vicumi-1300325441.cos.ap-beijing.myqcloud.com/通信原理/[通信原理][9.6]m序列自相关函数.png)

1. 扰码和解扰的原理

   1. 扰码——以线性反馈移位寄存器理论为基础

      ![image-20200504205852185](https://vicumi-1300325441.cos.ap-beijing.myqcloud.com/通信原理/[通信原理][9.6]扰码器.png)

      1. 表达式

         $$G = \frac{S}{\sum\limits_{i=0}^{n}C_{i}D^{i} }$$

         其中，$S$为输入数据序列，$G$为输出数据序列，$D$符号表示将序列延时1位，$D^k$即为延时$k$位。

      1. 举例

         假设一个4级移位寄存器（各级移位寄存器初始状态**全为0**）

         ![image-20200504210036497](https://vicumi-1300325441.cos.ap-beijing.myqcloud.com/通信原理/[通信原理][9.6]4级移位寄存器举例.png)

         1. 抽头处的序列表示
            ![image-20200504210339318](https://vicumi-1300325441.cos.ap-beijing.myqcloud.com/通信原理/[通信原理][9.6]4级移位寄存器抽头序列.png)
            分析：由图中可以看出，只有$C_4 = C_3 = 1$，则只需对序列进行移4位和3位，表示为$D^4 S$和$D^3 S$。以最后一位为例。在这一位上，$S$、$D^3 S$、$D^4 S$一共有奇数个1，则$G$的这一位为1；若某一位上前三排的序列共有偶数个1（如左数第二位，0个1），则$G$的这一位为0。  对照$G$的表达式发现，**在模二意义下， 乘除法都可以表示为异或**。
         2. 扰码器和m序列发生器的关系
            只要移位寄存器的**初始状态不全为0，则当输入序列为全0时**（即无数据输入），扰码器就是一个线性反馈移位寄存器序列发生器。

   2. 解扰器

   3. 采用扰码的主要缺点

      1. 导致误码增殖
      2. 当输入序列为某些伪随机码形式时，扰码器输出的可能是全0码

 

## 9.7 眼图

1. 眼图的概念

   1. 评价基带传输系统的一种定性的方法：观察接收端的基带信号波形
   1. $M$元码有$(M-1)$只眼睛

1. 眼图的特点

   <img src="https://vicumi-1300325441.cos.ap-beijing.myqcloud.com/通信原理/[通信原理][9.7]眼图的一般表述.png" alt="image-20200504213333275" style="zoom: 67%;" />

   1. 眼图张开部分的宽度决定了接收波形可以不受串扰影响而抽样、再生的时间间隔
   1. 抽样的最佳时刻是“眼睛”张开最大的时刻
   1. “眼睛”在特定抽样时刻的张开高度决定了系统的噪声容限
   1. “眼睛”的闭合斜率决定了系统对抽样定时误差的敏感程度，斜率愈大则对定时误差愈敏感

1. 眼图不但反映了串扰的大小，也反映了信道噪声的影响。当码间串扰或噪声很大的时候，“眼睛”就会完全闭合起来，系统不可能无误工作。$\rightarrow$ 对码间串扰进行校正 $\rightarrow$ **均衡**（消除码间串扰，不消除噪声）

 

## 9.8 均衡

1. 时域均衡原理——直接校正系统的时域冲激响应

   1. 常用方法：在基带信号接收滤波器之后插入一个横向滤波器（或称横截滤波器，也是FIR滤波器）

   1. 数学表述

      1. **有$(2N+1)$个抽头**，加权系数为$C_{-N}, C_{-N+1}, \cdots, C_{N}$（注意下标）

      1. 设输入波形序列为$\{x_k\}$，输出波形序列为$\{y_k\}$，则有

         $$y_k = \sum\limits_{i=-N}^{N}C_{i}x_{k-i},\ k=-2N,\cdots,0,\cdots,+2N$$

      1. 矩阵表述

         $$Y=XC$$

         其中各个矩阵有如下表示：

         $$Y^T = [y_{-2N} \ \cdots \ y_{0} \ \cdots \ y_{2N}]$$

         $$C^T = [C_{-N} \ \cdots \ C_{0} \ \cdots \ C_{N}]$$

         <center><img src="https://vicumi-1300325441.cos.ap-beijing.myqcloud.com/通信原理/[通信原理][9.8]输入序列矩阵.png" alt="image-20200504220926115" style="zoom:80%;" /></center>

1. 均衡算法及其实现

   1. 度量均衡效果的标准：通常为峰值畸变和均方畸变

      1. 峰值畸变：冲激响应所有的抽样时刻码间串扰值之和与$k=0$时刻抽样值之比

         $$D = \frac{1}{y_0} \sum\limits_{\substack{k=-\infty\\ k \neq0} }^{\infty} \left|y_k\right|$$

         1. 迫零算法：基于迫使码间串扰为零的均衡算法。实现方案：预置式——估计信道并提前计算好抽头系数，不再变化。
         1. 自适应均衡：在传输期间，**利用包含在在信号中的码间串扰信息自动调整抽头系数（不需要估计信道）**。

      1. 均方畸变（利用**均方误差**）

         $$\overline{e^2} = \sum\limits_{k=-N}^{N}(y_k - \delta_k)^2$$

         当**误差信号与输入抽样值的互相关系数为零**时，抽头系数为最佳。

   1. 实际系统

 

 

 

 

# 第十章 数字信号的载波传输

## 引言

+ 通带传输与基带传输

  1. 通带传输
     1. **不需调制**
     1. 编码后的数字脉冲信号直接在信道上传送
     1. 一般是**有线传输**

  2. 基带传输
     1. **需要调制（模拟/数字）**
     1. 信号/数据经过调制之后，再送到信道上
     1. **以无线传输为主，但是也可以有线传输**

 

## 10.1 二进制数字调制

### 1. 2ASK（二进制幅度键控）

1. 又称为“通-断键控（OOK）”

1. 频宽：二进制基带信号的2倍

1. 特点

   1. 频谱有冲激分量
   1. 幅度经过无线信道会严重失真
   1. 效率不高

1. 2ASK（OOK）的典型波形

   <img src="https://vicumi-1300325441.cos.ap-beijing.myqcloud.com/通信原理/[通信原理][10.1]2ASK波形.png" alt="image-20200611115220954" style="zoom:80%;" />

### 2. 2FSK（二进制频移键控）

1. 可以看作是两个不同载频的2ASK信号之和

1. 频宽：两倍基带信号带宽与两个载频差绝对值的和，即$\Delta f=2 B+\left|f_{2}-f_{1}\right|$

1. 特点

   1. 可以采用模拟信号调频电路来实现
   1. 可以使用键控法：切换速度快，波形好，频率稳定度高，但是**相位不连续**

1. 2FSKD典型波形

   <img src="https://vicumi-1300325441.cos.ap-beijing.myqcloud.com/通信原理/[通信原理][10.1]2FSK波形.png" alt="image-20200611120035900" style="zoom:80%;" />

### 3. 2PSK或BPSK（二进制相移键控）

1. 载波的相位随信号的1或0改变，通常用相位0度和180度来分别表示1或0.但是在时域表达式中，**系数是双极性的，即+1和-1**，这一点上就<u>与2ASK区分</u>开来了。

1. BPSK是**双极性**非归零码的双边带调制，而OOK是**单极性**非归零码的双边带调制。 同时，BPSK<u>还少了一个离散的载频分量</u>，因而BPSK又是一个抑制双边带调制。

1. 属于<u>绝对调相</u>：相位变化是以**未调载波的相位**作为参考基准，利用载波相位的绝对数值传送数字信息。

1. <u>**必须使用相干解调**</u>。无法使用滤波法提取本地载波。需要使用非线性变换产生新的频率分量。常用的载波恢复电路有

   1. 平方环电路
   1. 科斯塔斯环
   1. **相位糢糊度**：解调时，由于本地参考载波有$0$、$\pi$的糢糊度因此解调出来的数字信号可能完全相反，从而**0和1倒置**。
   1. 克服相位糢糊度的方法——**差分编码**，即DPSK。

1. 当数字信号传输速率（$1/T_s$，注意不是采样率）与载波频率有确定的倍数关系时，典型波形如下

   <img src="https://vicumi-1300325441.cos.ap-beijing.myqcloud.com/通信原理/[通信原理][10.1]2PSK波形.png" alt="image-20200611121610559" style="zoom:80%;" />

### 4. 2DPSK（二进制差分相移键控）

1. 属于<u>相对调相</u>：利用**前后码元的相对相位变化**传送数字信息。

1. 方法步骤
   1. 对数字基带信号进行**差分编码**：绝对码$\rightarrow$相对码
   1. **绝对调相**

1. 调制波形

   <img src="https://vicumi-1300325441.cos.ap-beijing.myqcloud.com/通信原理/[通信原理][10.1]DPSK波形.png" alt="image-20200611141535474" style="zoom:80%;" />

1. 解调方式

   1. 相干解调

   1. **差分相干解调**

      1. 不需要恢复本地载波

      1. 将DPSK**延时**一个码元间隔$T_s$

      1. <u>解调得到的相对码完全是0和1倒置，但是经过差分译码得到的绝对码不会发生任何倒置现象</u>，从而克服了相位糢糊的问题。

      1. 再与DPSK信号本身**相乘**

      1. 注意：<u>只有DPSK可以使用差分相干解调</u>

      1. 示意图

         <img src="https://vicumi-1300325441.cos.ap-beijing.myqcloud.com/通信原理/[通信原理][10.1]DPSK差分相干解调.png" alt="image-20200611142029740" style="zoom:80%;" />

## 10.2 数字信号的最佳接收

### 0. 数字通信最佳接收准则

1. 准则
   1.  <font color='red'><u>**最大输出信噪比**</u></font>
   1.  <font color='red'><u>**最小差错概率**</u></font>
1. 在高斯白噪声信道中，两者等价。

### 1. 匹配滤波器

1. 数字通信系统中滤波器的作用

   1. 使基带信号频谱成形
   1. 在接收端限制白噪声。将信号频带外的噪声过滤掉，减小它对信号正确判决的影响。

1. 最佳线性滤波器设计准则

   1. 使滤波之后的信号波形与发送信号之间的均方误差最小——维纳滤波器

   1. 使滤波器的输出信噪比在某一特定时刻上达到最大——**匹配滤波器**

      判决时刻的信噪比越高，越有利于作出正确的判决。

1. 匹配滤波器

   1. 滤波器的传递函数

      设$S(t)$为信号，它的频谱函数为$S(f)$，匹配滤波器的传递函数为$H(f)$，则

      $$H(f)=K S^{*}(f) e^{-j 2 \pi fT}$$

      **特点**

      1. 当滤波器传递函数满足上式的时候，在抽样时刻$t=T$时，SNR最大。
      1. 最大输出信噪比：${\rm SNR} = \frac{2E_s}{n_0}$。其中$E_s$为观察间隔内的信号能量。
      1. 匹配滤波器的**传递函数与信号频谱的复共轭成正比**。（其名字也因此而得。）
      1. 若输入信号为实信号，则$S^{*}(f) = S(-f)$，有$h(t) = KS(T-t)$。所以，**匹配滤波器的冲激响应是输入信号$S(t)$的镜像及平移**。

   1. 匹配滤波器接收机

      1. 二进制数字信号匹配滤波接收机

         有两个匹配滤波器，滤波器输出在$t=T$时刻抽样后，在进行比较，选择其中最大的信号作为输出结果（选择和判决）。

         <img src="https://vicumi-1300325441.cos.ap-beijing.myqcloud.com/通信原理/[通信原理][10.2]匹配滤波器.png" alt="image-20200611191441809" style="zoom:80%;" />

      1. 等效的最佳接收机

         匹配滤波器的输出信号波形与输入信号的自相关函数成比例：$y_S (t) = S(t) * h(t) = KR_S (t-T)$。因此，匹配滤波器的接收机可以看作一个等效的**<u>相关接收机</u>**。

         <img src="https://vicumi-1300325441.cos.ap-beijing.myqcloud.com/通信原理/[通信原理][10.2]相关接收机模型.png" alt="image-20200611191307294" style="zoom:80%;" />

      1.  <u>**<font color='red'>题型</font>**</u>：根据信号波形，构造匹配滤波器

 

### 2. 数字信号接收的统计模型

略。

 

### 3. 最小错误概率最佳接收机

1. 错误概率的计算

   1. 前提：

      1. 二进制数字调制
      1. 发送的信息只有两种$x_1$和$x_2$
      1. 对应的发送信号为$S_1 (t)$和$S_2 (t)$
      1. $x(t)$的条件概率密度分别为$f_{S1} (x)$和$f_{S2} (x)$。
      1. 发送$S_1(t)$和$S_2 (t)$的概率为$P(S_1)$和$P(S_2)$，通常已知。
      1. 设$P_{S1} (S_2)$为发送$S_1 (t)$而被错判为$S_2 (t)$的概率，$P_{S2} (S_1)$为发送$S_2 (t)$而被错判为$S_1 (t)$的概率。
      1. 判决门限设为$V_T$。

   1. 平均错误概率为

      $$\begin{aligned} P_{e} &=P_{S 1}\left(S_{2}\right) P\left(S_{1}\right)+P_{S 2}\left(S_{1}\right) P\left(S_{2}\right) \\ &=P\left(S_{1}\right) \int_{V_{T} }^{\infty} f_{S 1}(x) d x+P\left(S_{2}\right) \int_{-\infty}^{V_{T} } f_{S 2}(x) d x \end{aligned}$$

      在$P(S_1)$和$P(S_2)$已知的情况下，$P_e$仅与$V_T$有关。

1. 最佳判决满足的条件

   1. 最大似然法则（见教材P268）。
   1. 推广到有$m$个发送信号。

1. 最小错误概率下的（最大似然准则的）最佳接收机结构。

   1. 一般情况下的结构

      分为两种情况：（1）通用（2）两种信号发送概率相同。

      <img src="https://vicumi-1300325441.cos.ap-beijing.myqcloud.com/通信原理/[通信原理][10.2]最大似然准则下最佳接收机1.png" alt="image-20200611200129001" style="zoom:67%;" />

   1. 等效结构

      **<u>相关器</u>**使最佳接收机的关键部件。通过等效变化，**<u>最小差错概率准则下的最佳接收机与最大信噪比准则下的最佳接收机使等效的</u>**。再次强调，匹配滤波和最佳接收是等效的。

## 10.3 二进制数字调制的误比特率

### 1. 二进制最佳接收机的误比特率

1. 匹配滤波条件下二进制调制时最小误比特率

   1. 前提

      1. 设$E_{S1}$、$E_{S2}$分别为$S_1 (t)$和$S_2 (t)$在$0 \leq t \leq T_s$内的能量，当二进制调制时，信号有相同的能量，$E_{S 1}=E_{S 2}=E_{b}$，表示每比特的信号能量。
      1. 相关系数：$\rho$，$\rho \in (-1,1)$

   1. 最小误比特率

      $$P_{b}=Q[\sqrt{\frac{E_{b} }{n_{0} }(1-\rho)}]$$

1. 不同数字调制方式的误比特率

   1. 2ASK

      $$P_{b ,2 \mathrm{ASK} }=Q(\sqrt{E_{b} / n_{0} })$$

   1. 2PSK

      $$P_{b, 2 \mathrm{PSK} }=Q(\sqrt{2 E_{\mathrm{b} } / n_{0} })$$

   1. 2FSK

      $$P_{b, 2 \mathrm{FSK} }=Q(\sqrt{E_{b} / n_{0} })$$

1. 相干解调与最佳接收

   只有相干解调器中的滤波器（通带和基带任取一个）严格按照匹配滤波器的要求来设计，才是真正的最佳接收。

### 2. 二进制非相干解调时的误比特率

1. 2FSK非相干解调

   $$P_{b, \mathrm{NCFSK} }=\frac{1}{2} \exp \left(-E_{b} / 2 n_{0}\right)$$

   这就是**正交2FSK信号**在最佳非相干解调时的错误概率，也是**任何二进制正交信号**最佳非相干检测时候的错误概率。

1. 2ASK非相干解调

   $$P_{b, \mathrm{NCASK} }=\frac{1}{2} \exp \left(-E_{b} / 2 n_{0}\right)$$

   说明非相干解调时，2ASK和2FSK的误码性能一样。

1. 2DPSK差分相干解调

   $$P_{b, \mathrm{2DPSK} }=\frac{1}{2} \exp \left(-E_{b} / n_{0}\right)$$

### 3. 关于二进制误比特率的说明（🔔️）

1. 对于同一种数字调制信号，采用相干解调的误码率低于采用非相干解调的误码率。
1. PSK相干解调的抗白噪声能力优于2ASK和2FSK的相干解调。
   1. 在**相同的误比特率**的情况下，2PSK相干解调所要求的$E_b / n_0$比2ASK和2FSK要**低3dB**，这意味着发送的信号能量可以减半。
   1. 在**误码率一定**的情况下，2PSK系统所需要的**信噪比**比2ASK和2FSK都要**低3dB**，换算成倍数即2PSK的信噪比要求是2ASK和2FSK的一半。
1. PSK的非相干解调的抗白噪声能力优于2ASK和2FSK的非相干解调。

### 4. 信噪比，$E_b/N_0$和带宽的区分

1. 符号速率与比特率

   $$R_{b}=\frac{1}{T_{s} } \log _{2} M=R_{s} \log _{2} M$$

1. 符号能量与比特能量

   1. 平均信号功率

      $$S=\frac{E_{s} }{T_{s} }=E_{a} R_{s}=E_{s} R_{b} / \log _{2} M$$

   1. 发送1bit的能量与发送一个比特的能量

      $$E_{b}=E_{s} / \log _{2} M$$

1. 信噪比与能量和速率的关系

   信号能量为

   $$S=E_{b} R_{b}$$

   噪声能量为

   $$N = n_0 B$$

   所以信噪比为

   $$\frac{S}{N}=\left(\frac{E_{b} }{n_{0} }\right)\left(\frac{R_{b} }{B}\right)$$

1. 带宽的概念

   最佳接收时接收机的带宽和信号带宽是一致的。

<img src="https://vicumi-1300325441.cos.ap-beijing.myqcloud.com/通信原理/[通信原理][10.3]信噪比和带宽的概念.png" alt="image-20200611210330965" style="zoom:80%;" />

## 10.4 多进制数字调制

1. 多进制数字调制的特点

   1. 每个<u>符号</u>可以携带$\log_2 M$比特的信息，提高了频带利用率
   1. 代价：增加信号功率和实现上的复杂性

1. 多进制幅度键控（MASK）

1. 多进制相移键控（MPSK）

   1. 矢量图/星座图表示

   1. MPSK的调制

      正交调制器，对应于信号的正交分解。MPSK中最常用的是<u>4PSK（或称QPSK）</u>，可以看作由两个BPSK组成。

   1. MPSK的解调

      1. 使用两个正交的载波信号实现相干解调（正交相干解调）——正交路和同相路分别设置两个相关器（或匹配滤波器）。
      1. 存在**相位糢糊度的**问题：有$M$重相位糢糊度。

   1. 误码性能：使用**格雷码**时，误码率与误比特率之间存在关系$P_{b, \text { MPSK } } \approx P_{s, M F S K} / \log _{2} M$

1. 多进制频移键控（MFSK）

   MFSK调制器：$M$个等幅不等频的2ASK信号叠加，带宽为$f_H - f_L + 2W$。

1. 幅度与相位结合的多进制调制（MQAM，MQPR）

   1. 充分利用信号平面
      1. 在不减少信号点之间距离$d$的情况下增加$M$，提高频谱利用率。
      1. 在$M$不变的而情况下增加$d$，改善当$M$较大时候的抗噪性能。

   1. 正交幅度调制（QAM）
      1. 星座图常为矩形（方形）和十字形（星形）
         1. 在多径衰落信道中，振幅和相位的取值越多，信号受信道的影响越大，因此，星形比方形更有吸引力。
         1. 但是，方形星座的QAM信号的生成与接收更易实现，因此，在实际通信中应用广泛。
      1. MQAM正交调制器和正交解调器
         1. 调制：正交调制
         1. 解调：正交相干解调

   1. 正交部分响应幅度调制（MQPR）

      同相路和正交路的基带信号都采用的是部分响应信号。

1. 关于星座图

   <img src="https://vicumi-1300325441.cos.ap-beijing.myqcloud.com/通信原理/[通信原理][10.4]星座图概念.png" alt="image-20200612163446981" style="zoom: 67%;" />

 

## 10.5 恒包络调制

1. 出现的原因：非线性限带信道产生的包络**畸变**，以及**临道干扰**。

1. 偏移四相相移键控（OQPSK）

1. 最小频移键控（MSK）

   1. 能够产生恒定包络、连续相位信号的调制

   1. MSK是2FSK的一种特殊情况。它据有<u>正交信号的最小频差</u>，在<u>相邻符号的交界处相位保持连续</u>。

   1. 最小频差

      $$\Delta f=f_{2}-f_{1}=\frac{1}{2 T_{s} }=\frac{1}{2 T_{b} }$$

      其中，$f_1$、$f_2$为2FSK信号的两个频率，$T_s$为信号码元间隔，$T_b$为二进制信息的间隔。

   1. 相位网络图

      1. MSK的信号表达式：$S_{\rm MSK }(t)=A \cos \left[2 \pi f_{C} t+\frac{p_{n} \pi t}{2 T_{b} }+\phi(0)\right]$

         <u>其中，$p_n = \pm 1 $，分别表示二进制的1和0</u>。$\phi(0)$为初相。

      1. 相位网络图：每比特变化$\pm \frac{\pi}{2}$，因此累计相位$\phi(t)$在每比特结束时必定为$\frac{\pi}{2}$的整数倍。奇数倍$T_b$时刻奇数倍，偶数倍$T_b$时刻偶数倍。图中粗线路径表示而信息序列为1101000。

         <img src="https://vicumi-1300325441.cos.ap-beijing.myqcloud.com/通信原理/[通信原理][10.5]相位网络图.png" alt="image-20200612170854856" style="zoom:60%;" />

   1. MSK的调制与解调

      1. 调制：正交调制
      1. 解调：看作正交2FSK时，可以使用相干解调，也可以使用鉴相器法进行非相干解调。以及，也可以使用差分解调。

## 10.6 各种数字调制的比较

### 1. 香农公式（🔔️）

1. 香农公式

   $$C=W \log _{2}\left(1+\frac{S}{N}\right)$$

1. 香农公式的说明

   1. 变形：$\frac{C}{W}=\log _{2}\left(1+\frac{S}{N}\right)=\log _{2}\left(1+\frac{E_{b} / T_{b} }{n_{0} W}\right)$

   1. 极限情况下，$C = \frac{1}{T_b}$，即信道容量等于信息传输速率。因此$\frac{C}{W}=\log _{2}\left(1+\frac{E_{b} }{n_{0} } \frac{C}{W}\right)$

   1.  <font color='red'>**<u>香农极限：当$C/W \rightarrow 0$时，$E_b / n_0 \rightarrow \ln 2 = -1.6 {}\rm dB$。这是实现无误传输所需要的最低$E_b / n_0 $，称为香农极限。</u>**</font>

   1.  <font color='red'>**<u>信道容量的极限</u>**</font>

       <font color='red'>$\lim_\limits{W \rightarrow \infty} C=\lim_\limits{W \rightarrow \infty} W \log _{2}\left(1+\frac{S}{n_{0} W}\right)=\frac{S}{n_{0} } \lim_\limits{W \rightarrow \infty} \frac{n_{0} W}{S} \log _{2}\left(1+\frac{S}{n_{0} W}\right)=\frac{S}{n_{0} } \log _{2} e=1.44 \frac{S}{n_{0} }$</font>

### 2. 不同数字调制方式的性能

见教材。

 

 

# 第十一章 差错控制编码和线性分组码

## 11.1 差错控制编码

1. 差错控制编码属于**信道编码**

1. 差错控制方式

   1. 检错重发（ARQ）
      1. 停发等候重发
      1. 返回重发
      1. 选择重发
   1. 前向纠错（FEC）
   1. 混和纠错（HEC）

1. 差错控制编码的基本原理

   1. 与不进行信道编码的情况相比，信道编码在相同信噪比的情况下会获得更好的系统性能。

   1. 差错控制是以<u>牺牲传输效率换来的传输质量的提高</u>。

   1. 一些例子，以供参考和理解

      <img src="https://vicumi-1300325441.cos.ap-beijing.myqcloud.com/通信原理/[通信原理][11.1]差错控制编码原理.png" alt="image-20200612194226780" style="zoom:70%;" />

      <img src="https://vicumi-1300325441.cos.ap-beijing.myqcloud.com/通信原理/[通信原理][11.1]差错控制编码原理2.png" alt="image-20200612194352946" style="zoom:70%;" />

      <img src="https://vicumi-1300325441.cos.ap-beijing.myqcloud.com/通信原理/[通信原理][11.1]差错控制编码原理3.png" alt="image-20200612194457200" style="zoom:70%;" />

1. 差错控制编码的分类（教材P324）

1. **检错和纠错的基本原理**

   1. 基本概念

      1. 码重：码组中非零码元的数量
      1. 汉明距（码距）：两个码组中对应码位上具有不同的二进制码元的位数
      1. 最小码距：所用码字中任何两个码字之间码距的最小值，记作$d_{\min}$。

   1. 由最小码距决定码组的纠错和检错性能

      1. 在一个码组内**检测**$e$个误码：$d_{\min} \geq e +1$

      1. 在一个码组内**纠正**$t$个误码：$d_{\min} \geq 2t +1$

      1. 在一个码组内**纠正**$t$个误码，同时**检测**$e$个误码，其中$e \geq t$：$d_{\min} \geq t + e +1$

      1. 使用图示来理解

         <img src="https://vicumi-1300325441.cos.ap-beijing.myqcloud.com/通信原理/[通信原理][11.1]检错和纠错能力图示.png" alt="image-20200612203722916" style="zoom:60%;" />

1. 常用的简单编码（教材P327起）

1.  <font color='red'>**<u>有扰离散信道的编码定理（香农信道编码定理）</u>**</font>

   1. 内容

      若信道容量为$C$，则只要发送端以**低于**$C$的速率$R$发送信息（$R$为编码器的输入二进制码元速率），则**一定存在**一种编码方法，使编码错误概率$P$随着码长$n$的增加，**按指数下降到任意小**的值。表示为

      $$P \leq e^{-nE(R)}$$

      其中，$E(R)$为误差指数。在$C$不变时，$R \uparrow$，$E(R) \downarrow$，$P \uparrow$；在$R$不变时，$C \uparrow$，$E(R) \uparrow$，$P \downarrow$。

   1. 结论

      1. 在码长及发送速率一定的情况下，为减小$P$，可以增大信道容量。
      1. 在信道容量及发送信息速率一定的情况下，增加码长，可以使错误概率下降。

 

## 11.2 线性分组码

1. 基本概念
   1. 奇偶校验码是最简单的线性码。其中只有一位监督码元，只能表示有错和无错。
   1. 线性码组中只存在一种运算，即**<u>模2和</u>**。（有关各位之间的运算，“+”号即表示模2和）
   1. 线性分组码：将信息码分组，每组增加若干监督位，且信息位和监督位间的关系可以用线性方程组来表示编码。
   1. 线性分组码的表示：<u>码组长度为$n$，有$k$位信息码元和$r=n-k$位监督码元，记作$(n,k)$码</u>。
   1. **校正子**（或称伴随式）：用于检错或纠错的计算式得到的结果称为校正子，该计算式称为**监督方程式**。
   1. 一般来说，由$r$个监督方程式计算得到的校正子有$r$位，<u>可以得到$2^r -1$种误码图样</u>。对于一位误码来说，就可以用来指示$2^r -1$个误码位置。
   1. 对于$(n,k)$分组码，如果**满足**$2^r -1 \geq n$就可以构造出纠正一位甚至更多位的分组码。（解释：即能指示的误码位数多余实际的编码长度）
   1. 纠错码构造原理——以$(7,4)$码为例。
      1. 计算出信息码元数和监督码元数分别为$4$和$3$。
      1. 确定监督码元和信息码元的位置，分别为监督码$a_2$ ~ $a_0$，信息码$a_6$ ~ $a_3$
      1. 根据$r=3$，说明需要三个校正子，设为$S_1$、$S_2$、$S_3$。
      1. 对照校正子与误码位置的对应关系表，列写监督方程式。（看当误码位置在哪里，$S_i$校正子为1，则该位置的码元就算一个加数写在$S_i$方程的另一边，注意表示的是模2和）
      1. 改写方程组，将$S_i$都写成0，并把各方程中的码$a_2$ ~ $a_0$移到等号的另一边。注意，在模2和的计算条件下，<u>“-”等同于“+”</u>。
      1. 根据<u>第5步</u>所得到的方程组，可以得到$2^k=16$个**许用码组**。
      1. 当传输时接收到一个码组$a_6$ ~ $a_0$，可以根据<u>第4步</u>中的方程式计算出$S_1 S_2 S_3$，再对照校正子和误码位置的对照表可以判断出哪一位发生了错误。
      1. $(7,4)$码的最小码距是$d_{\min}=3$，能纠正1位误码和检测两位误码。
   1. $(n,k)$码的<u>编码效率（编码速率）</u>：$\frac{k}{n}=1-\frac{r}{n}$

1. 监督矩阵（校验矩阵）

   上一部分$(7,4)$码的构造过程中，第5步的方程组可以该写成矩阵的形式（此处从略，见教材P333）。记作

   $$H A^T = O^T \quad \text{或} \quad AH^T = O$$

   其中，

   + $H$称为$r \times n$的**监督矩阵**。矩阵中的元素“1”表示相应位之间存在偶校验的关系。
   + $H$可以分为左右两部分$[P \quad I_r]$，左边部分为$r \times k$矩阵$P$，右边为$r \times r$**单位方阵**$I_r$，具有该形式的$H$矩阵称为**典型形式监督矩阵**。
   + 典型形式监督矩阵各行一定是线性无关的，非典型形式监督矩阵可以化为典型形式。
   + 监督矩阵是接收端检错的依据，由典型形式监督矩阵以及信息码元可以计算出各个监督码元。

1. 生成矩阵

   1. 取出监督矩阵$H$中的矩阵$P$做转置，得到矩阵$Q$。再在其左边添加一个$k \times k$阶方阵$I_k$，得到一个新的矩阵$G = [I_k \quad Q]$，该矩阵称为**生成矩阵**。
   1. 生成矩阵可以 整个码组$A$。以$(7,4)$码为例，有$A = [\begin{matrix} a_6 & a_5 & a_4 & a_3 \end{matrix}] \cdot G$。
   1. $G = [I_k \quad Q]$形式的生成矩阵称为典型形式的生成矩阵，由它产生的 分组码一定是**系统码**——信息码元不变，监督码元附加在其后。
   1. 典型形式的生成矩阵各行线性无关，每行都是一个许用码组。$k$行许用码组经过运算可以生成$2^k$个不同的许用码组。

1. 校正子（伴随式）

   1. 校正子只与$E$有关，即错误图样与校正子之间有着确定的关系。

   1. 要纠正小于或等于$t$个错，必须满足

      $$2^{r}-1 \geq C_{n}^{1}+C_{n}^{2}+\cdots+C_{n}^{t}$$

      或写成

      $$2^{r} \geq \sum_\limits{i=0}^{t} C_{n}^{i}$$

1. 汉明码

   汉明码有以下特点：

   <img src="https://vicumi-1300325441.cos.ap-beijing.myqcloud.com/通信原理/[通信原理][11.2]汉明码的特点.png" alt="image-20200613001248095" style="zoom:60%;" />

 

## 11.3 循环码

1. 循环码也是一种线性分组码

2. 循环码的性质

   1. 封闭性：任何许用码组许用码组的线性和还是许用码组
   2. 循环性：任何许用码组循环移位之后依然是许用码组

3. 码多项式

   1. 许用码组$A=\left(a_{n-1} a_{n-2} \cdots a_{1} a_{0}\right)$可以表示为

      $$A(D)=a_{n-1} D^{n-1}+a_{n-2} D^{n-2}+a_{n-3} D^{n-3}+\dots+a_{1} D+a_{0}$$

      其中$D$为以个任意的实变量，它的幂次表示**移位的次数**。加发表示的是**模2和**。

   2. 一个长为$n$的循环码必定为按模$(D^n+1)$运算的一个余式，可以表示为

      $$A^{(i)}(D) \equiv D^{i} A(D) \bmod \left(D^{n}+1\right)$$

      注意其中涉及到的**除法运算中的减法运算也是模2和**。

4. 生成多项式

   1. 循环码完全由其码组长度$n$以及生成多项式$g(D)$所决定。在循环码中，$n-k$阶次幂的码多项式有且只有一个，对应于生成多项式$g(D)$。

   2. $g(D)$是一个能除尽$(D^n+1)$的$r=n-k$阶多项式。

   3. 阶数小于等于$n-1$且能被$g(D)$除尽的每个多项式都是循环码的许用码组。

   4. 举例说明1

      <img src="https://vicumi-1300325441.cos.ap-beijing.myqcloud.com/通信原理/[通信原理][11.3]生成多项式举例.png" alt="image-20200613003752454" style="zoom:80%;" />

   5. 举例说明2

      <img src="https://vicumi-1300325441.cos.ap-beijing.myqcloud.com/通信原理/[通信原理][11.3]生成多项式举例2.png" alt="image-20200613004214636" style="zoom:80%;" />

   6. 生成多项式的构造

      1. 特殊情况$(n,n-1)$码：简单的偶监督码。
      2. 特殊情况$(n,1)$码：重复码，$d_{\min}=n$，又称$n$重重复码。

5. 循环码的生成矩阵与监督矩阵

   1. 生成矩阵

      1. 监督码多项式

         $$\begin{aligned} r(D) &=\boldsymbol{A}(D)+M(D) D^{n-k} \\ & \equiv M(D) D^{n-k} \quad \bmod g(D) \end{aligned}$$

         其中$M(D)$是信息码组。

      2. 系统循环码生成多项式的一般表示

         $$G(D)=\left[\begin{array}{c} C_{1}(D) \\ C_{2}(D) \\ \vdots \\ C_{k}(D) \end{array}\right]=\left[\begin{array}{ccc} D^{n-1} & + & r_{1}(D) \\ D^{n-2} & + & r_{2}(D) \\ & \vdots & \\ D^{n-k} & + & r_{k}(D) \end{array}\right]$$

      3. 生成矩阵举例1

         <img src="https://vicumi-1300325441.cos.ap-beijing.myqcloud.com/通信原理/[通信原理][11.3]生成矩阵举例1.png" alt="image-20200613005311586" style="zoom:80%;" />

      4. 生成矩阵举例2（教材P342，例11-1）

         <img src="https://vicumi-1300325441.cos.ap-beijing.myqcloud.com/通信原理/[通信原理][11.3]生成矩阵举例2.png" alt="image-20200613005411872" style="zoom:80%;" />

   2. 监督矩阵

      1. 监督多项式：由于$g(D)$能除尽$(D^n + 1)$，因此有$D^{n}+1=g(D) h(D)$，其中$h(D)$称为监督多项式，$h(D)=h_{k} D^{k}+\dots+h_{1} D + h_0$。

      2. 监督矩阵

         $$H=\left[\begin{array}{cccccc} h_{0} & h_{1} & \cdots & h_{k} & & & \\ & & & & & & 0 \\ & h_{0} & h_{1} & \cdots &  & h_{k} & & \\ 0 & & \ddots & \ddots & & \ddots & & \\ & & & h_{0} & h_{1} & \cdots & h_{k} \end{array}\right]$$

   3. 循环码编码器

      1. 编码过程的表示

         $$\frac{D^{n-k} \cdot M(D)}{g(D)}=q(D)+\frac{r(D)}{g(D)}$$

      2. 系统循环码多项式

         $$A(D)=D^{n-k} \cdot M(D)+r(D)$$

      3. 举例

         <img src="https://vicumi-1300325441.cos.ap-beijing.myqcloud.com/通信原理/[通信原理][11.3]循环码编码器举例.png" alt="image-20200613010532572" style="zoom:80%;" />

      4. 电路结构：多项式除法可以使用带反馈的线性移位寄存器实现。分为**内接异或**和**外接异或法**，通常用内接法。

         留意一下<u>设计框图</u>。

   4. 循环码的译码器

      1. 译码步骤

         <img src="https://vicumi-1300325441.cos.ap-beijing.myqcloud.com/通信原理/[通信原理][11.3]循环码译码器步骤.png" alt="image-20200613010933273" style="zoom: 45%;" />

      2. 检错

      3. 纠错